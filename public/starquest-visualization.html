<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StarQuest: How the Magic Works ‚ú®</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
<style>
/* ============================================================
   CSS CUSTOM PROPERTIES
   ============================================================ */
:root {
  --night-deep: #0f172a;
  --night-swirl: #1e3a5f;
  --night-bright: #2563eb;
  --cosmic: #312e81;
  --star-gold: #FFD700;
  --star-glow: #FEF08A;
  --star-warm: #FBBF24;
  --success: #10B981;
  --warning: #F59E0B;
  --danger: #EF4444;
  --glass-bg: rgba(75, 85, 160, 0.5);
  --glass-border: rgba(255, 255, 255, 0.15);
  --text-primary: #e2e8f0;
  --text-muted: #94a3b8;
  --indigo: #4F46E5;
  --section-pad: 80px 24px;
  --radius: 16px;
  --radius-sm: 8px;
}

/* ============================================================
   KEYFRAMES
   ============================================================ */
@keyframes twinkle {
  0%, 100% { opacity: 0.4; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.3); }
}

@keyframes cosmicShimmer {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes floatUp {
  0% { transform: translateY(0) rotate(0deg); opacity: 0.7; }
  100% { transform: translateY(-120vh) rotate(360deg); opacity: 0; }
}

@keyframes pendingPulse {
  0%, 100% { box-shadow: 0 0 6px 2px rgba(251,191,36,0.3); }
  50% { box-shadow: 0 0 18px 6px rgba(251,191,36,0.8); }
}

@keyframes slideInUp {
  from { transform: translateY(40px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes starBounce {
  0% { transform: scale(0) rotate(-10deg); opacity: 0; }
  60% { transform: scale(1.15) rotate(4deg); }
  80% { transform: scale(0.95); }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

@keyframes rowInsert {
  0% { background: rgba(255,215,0,0.4); transform: translateX(-20px); opacity: 0; }
  40% { background: rgba(255,215,0,0.3); transform: translateX(4px); opacity: 1; }
  100% { background: transparent; transform: translateX(0); opacity: 1; }
}

@keyframes goldFlash {
  0%, 100% { background-color: transparent; }
  50% { background-color: rgba(255,215,0,0.4); }
}

@keyframes navGlow {
  0%, 100% { box-shadow: 0 0 4px rgba(255,215,0,0.3); }
  50% { box-shadow: 0 0 12px rgba(255,215,0,0.8); }
}

@keyframes spinStar {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes dataPacket {
  0% { offset-distance: 0%; opacity: 1; }
  90% { opacity: 1; }
  100% { offset-distance: 100%; opacity: 0; }
}

@keyframes counterUp {
  from { transform: translateY(8px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes pulseRing {
  0% { transform: scale(1); opacity: 0.8; }
  100% { transform: scale(1.8); opacity: 0; }
}

@keyframes shimmerText {
  0% { background-position: -200% center; }
  100% { background-position: 200% center; }
}

/* ============================================================
   BASE RESET & LAYOUT
   ============================================================ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--night-deep);
  color: var(--text-primary);
  overflow-x: hidden;
  line-height: 1.6;
}

/* ============================================================
   NAVIGATION
   ============================================================ */
#nav {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 24px;
  background: rgba(15, 23, 42, 0.85);
  backdrop-filter: blur(16px);
  border-bottom: 1px solid var(--glass-border);
}

#nav-brand {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--star-gold);
  text-shadow: 0 0 12px rgba(255,215,0,0.4);
  letter-spacing: 0.5px;
}

#nav-dots {
  display: flex;
  gap: 10px;
  align-items: center;
}

.nav-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: rgba(255,255,255,0.25);
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
}

.nav-dot:hover { background: var(--star-warm); }

.nav-dot.active {
  background: var(--star-gold);
  border-color: rgba(255,215,0,0.4);
  animation: navGlow 2s ease-in-out infinite;
}

#progress-bar {
  position: fixed;
  top: 0;
  left: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--star-gold), var(--star-warm), var(--indigo));
  z-index: 1001;
  transition: width 0.2s ease;
  width: 0%;
}

/* ============================================================
   SECTION BASE
   ============================================================ */
section {
  min-height: 100vh;
  padding: var(--section-pad);
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.section-label {
  font-size: 0.85rem;
  font-weight: 600;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--star-warm);
  margin-bottom: 12px;
  opacity: 0.8;
}

h2.section-title {
  font-size: clamp(1.8rem, 4vw, 2.8rem);
  font-weight: 800;
  text-align: center;
  margin-bottom: 16px;
  background: linear-gradient(135deg, var(--star-gold), var(--star-warm), var(--star-glow));
  background-size: 200% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: shimmerText 4s linear infinite;
}

.section-subtitle {
  font-size: 1.25rem;
  color: var(--text-muted);
  text-align: center;
  max-width: 600px;
  margin-bottom: 48px;
}

/* Scroll reveal */
.reveal {
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}
.reveal.visible { opacity: 1; transform: translateY(0); }
.reveal-delay-1 { transition-delay: 0.1s; }
.reveal-delay-2 { transition-delay: 0.2s; }
.reveal-delay-3 { transition-delay: 0.3s; }
.reveal-delay-4 { transition-delay: 0.4s; }

/* ============================================================
   GLASS CARD
   ============================================================ */
.glass-card {
  background: var(--glass-bg);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 24px;
}

.cosmic-border {
  border: 1px solid rgba(255,215,0,0.3);
  box-shadow: 0 0 20px rgba(255,215,0,0.1), inset 0 0 20px rgba(49,46,129,0.3);
}

/* ============================================================
   SECTION 1: HERO
   ============================================================ */
#section-hero {
  background: linear-gradient(135deg, var(--night-deep) 0%, var(--night-swirl) 50%, var(--cosmic) 100%);
  text-align: center;
  position: relative;
  overflow: hidden;
}

#starfield-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
}

#hero-content {
  position: relative;
  z-index: 2;
  max-width: 760px;
}

#hero-title {
  font-size: clamp(2.2rem, 6vw, 4rem);
  font-weight: 900;
  line-height: 1.15;
  margin-bottom: 12px;
  text-shadow: 0 0 30px rgba(255,215,0,0.3);
  background: linear-gradient(135deg, #FEF08A, var(--star-gold), var(--star-warm));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

#hero-subtitle-zh {
  font-size: 1.3rem;
  color: rgba(254,240,138,0.7);
  margin-bottom: 24px;
  font-weight: 500;
}

#hero-intro {
  font-size: 1.15rem;
  color: var(--text-primary);
  max-width: 580px;
  margin: 0 auto 36px;
  background: rgba(15,23,42,0.5);
  border-radius: var(--radius);
  padding: 20px 28px;
  border: 1px solid var(--glass-border);
  line-height: 1.8;
  text-align: left;
}

#hero-intro-tagline {
  text-align: center;
  font-size: 0.9rem;
  color: var(--text-muted);
  padding-bottom: 14px;
  margin-bottom: 4px;
  border-bottom: 1px solid var(--glass-border);
  font-style: italic;
}

.hero-feature-row {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 12px 0;
  border-bottom: 1px solid rgba(255,255,255,0.06);
  font-size: 1rem;
  line-height: 1.5;
}

.hero-feature-icon {
  font-size: 1.6rem;
  min-width: 36px;
  text-align: center;
  flex-shrink: 0;
}

#floating-emojis {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  overflow: hidden;
}

.float-emoji {
  position: absolute;
  font-size: 1.8rem;
  animation: floatUp linear infinite;
  opacity: 0.7;
  bottom: -50px;
}

#scroll-cue {
  margin-top: 32px;
  font-size: 1rem;
  color: rgba(254,240,138,0.7);
  letter-spacing: 1px;
  animation: twinkle 2s ease-in-out infinite;
}

/* ============================================================
   SECTION 2: ARCHITECTURE
   ============================================================ */
#section-arch {
  background: linear-gradient(180deg, var(--night-deep) 0%, #0d1b2a 100%);
}

#arch-container {
  width: 100%;
  max-width: 800px;
  position: relative;
}

.arch-layer {
  border-radius: var(--radius);
  padding: 0;
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  overflow: hidden;
  border: 2px solid transparent;
}

.arch-layer:hover { transform: scale(1.01); }

.arch-layer.active { border-color: var(--star-gold); }

.arch-layer-header {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 20px 24px;
}

.arch-layer-icon {
  font-size: 2rem;
  min-width: 48px;
  text-align: center;
}

.arch-layer-text h3 {
  font-size: 1.2rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 4px;
}

.arch-layer-text p {
  font-size: 0.9rem;
  color: var(--text-muted);
}

.arch-layer-chevron {
  margin-left: auto;
  font-size: 1.2rem;
  transition: transform 0.3s;
  color: var(--text-muted);
}

.arch-layer.active .arch-layer-chevron { transform: rotate(180deg); }

.arch-detail {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
  border-top: 0px solid var(--glass-border);
}

.arch-layer.active .arch-detail {
  max-height: 320px;
  border-top: 1px solid var(--glass-border);
}

.arch-detail-inner {
  padding: 20px 24px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 12px;
}

.arch-component-chip {
  background: rgba(0,0,0,0.25);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-sm);
  padding: 10px 14px;
  font-size: 0.85rem;
}

.arch-component-chip strong {
  display: block;
  color: var(--text-primary);
  margin-bottom: 2px;
}

.arch-component-chip span {
  color: var(--text-muted);
  font-size: 0.88rem;
}

#arch-layer-browser { background: linear-gradient(135deg, rgba(37,99,235,0.3), rgba(30,58,95,0.5)); }
#arch-layer-server  { background: linear-gradient(135deg, rgba(79,70,229,0.35), rgba(49,46,129,0.5)); }
#arch-layer-db      { background: linear-gradient(135deg, rgba(16,185,129,0.25), rgba(5,46,22,0.4)); }

/* SVG arrows between arch layers */
#arch-arrows {
  position: absolute;
  left: -60px;
  top: 0;
  width: 50px;
  height: 100%;
  z-index: 10;
}

.arch-arrow-group { position: relative; }

#arch-svg-container {
  position: relative;
  display: flex;
  gap: 12px;
  align-items: flex-start;
}

#arch-svg-panel {
  width: 60px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 68px;
  gap: 0;
}

/* ============================================================
   SECTION 3: TWO WORLDS
   ============================================================ */
#section-twoworlds {
  background: linear-gradient(180deg, #0d1b2a 0%, #0f172a 100%);
}

#twoworlds-grid {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 0;
  width: 100%;
  max-width: 900px;
  align-items: start;
}

.role-panel {
  padding: 24px 20px;
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  border: 2px solid transparent;
}

#role-parent {
  background: linear-gradient(135deg, rgba(37,99,235,0.2), rgba(79,70,229,0.15));
  border-radius: var(--radius) 0 0 var(--radius);
  text-align: right;
}

#role-child {
  background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(5,150,105,0.1));
  border-radius: 0 var(--radius) var(--radius) 0;
  text-align: left;
}

#role-parent.selected { border-color: var(--indigo); background: linear-gradient(135deg, rgba(37,99,235,0.35), rgba(79,70,229,0.25)); }
#role-child.selected  { border-color: var(--success); background: linear-gradient(135deg, rgba(16,185,129,0.25), rgba(5,150,105,0.15)); }

.role-header {
  font-size: 1.5rem;
  font-weight: 800;
  margin-bottom: 8px;
}

.role-tagline {
  font-size: 0.85rem;
  color: var(--text-muted);
  margin-bottom: 20px;
}

.role-feature {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 0;
  font-size: 0.9rem;
  color: var(--text-muted);
  border-bottom: 1px solid rgba(255,255,255,0.05);
  transition: color 0.2s;
}

#role-parent .role-feature { flex-direction: row-reverse; }
#role-child  .role-feature { flex-direction: row; }

.role-panel.selected .role-feature { color: var(--text-primary); }

.role-feature-icon { font-size: 1.2rem; }

#phone-frame-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 0 16px;
}

#phone-frame {
  width: 220px;
  height: 440px;
  background: #0a0f1a;
  border-radius: 32px;
  border: 3px solid rgba(255,255,255,0.15);
  box-shadow: 0 20px 60px rgba(0,0,0,0.6), inset 0 0 30px rgba(255,255,255,0.03);
  overflow: hidden;
  position: relative;
  transition: all 0.4s ease;
}

#phone-notch {
  width: 80px;
  height: 22px;
  background: #0a0f1a;
  border-radius: 0 0 14px 14px;
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  border: 3px solid rgba(255,255,255,0.1);
  border-top: none;
}

#phone-screen {
  position: absolute;
  inset: 0;
  padding: 36px 12px 16px;
  overflow: hidden;
  transition: opacity 0.3s ease;
}

.phone-app-header {
  background: linear-gradient(135deg, #1e3a5f, #312e81);
  margin: 0 -12px;
  padding: 12px 16px;
  margin-top: -36px;
  padding-top: 48px;
  margin-bottom: 12px;
  font-size: 0.8rem;
  font-weight: 700;
}

.phone-quest-card {
  background: rgba(75,85,160,0.4);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  padding: 10px 12px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 0.85rem;
  animation: starBounce 0.5s ease;
}

.phone-badge {
  padding: 2px 8px;
  border-radius: 20px;
  font-size: 0.78rem;
  font-weight: 700;
  margin-left: auto;
  white-space: nowrap;
}

.badge-gold { background: rgba(255,215,0,0.2); color: var(--star-gold); border: 1px solid rgba(255,215,0,0.3); }
.badge-green { background: rgba(16,185,129,0.2); color: var(--success); border: 1px solid rgba(16,185,129,0.3); }
.badge-red { background: rgba(239,68,68,0.2); color: var(--danger); border: 1px solid rgba(239,68,68,0.3); }

#phone-role-label {
  font-size: 0.8rem;
  color: var(--text-muted);
  text-align: center;
}

#twoworlds-insight {
  margin-top: 32px;
  max-width: 600px;
  text-align: center;
  padding: 16px 24px;
  background: rgba(251,191,36,0.08);
  border: 1px solid rgba(251,191,36,0.25);
  border-radius: var(--radius);
  font-size: 0.95rem;
  color: var(--star-glow);
}

/* ============================================================
   SECTION 4: JOURNEY
   ============================================================ */
#section-journey {
  background: linear-gradient(180deg, #0f172a 0%, var(--night-swirl) 100%);
}

#journey-progress {
  display: flex;
  gap: 8px;
  margin-bottom: 40px;
  align-items: center;
}

.journey-dot {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.85rem;
  font-weight: 700;
  background: rgba(255,255,255,0.1);
  border: 2px solid rgba(255,255,255,0.2);
  color: var(--text-muted);
  transition: all 0.3s ease;
  cursor: pointer;
}

.journey-dot.active {
  background: var(--star-gold);
  border-color: var(--star-warm);
  color: var(--night-deep);
  transform: scale(1.2);
  box-shadow: 0 0 16px rgba(255,215,0,0.5);
}

.journey-dot.done {
  background: rgba(16,185,129,0.3);
  border-color: var(--success);
  color: var(--success);
}

.journey-connector {
  width: 24px;
  height: 2px;
  background: rgba(255,255,255,0.15);
  transition: background 0.3s;
}

.journey-connector.done { background: var(--success); }

#journey-stage {
  width: 100%;
  max-width: 700px;
  min-height: 360px;
  position: relative;
}

#journey-step-card {
  background: var(--glass-bg);
  backdrop-filter: blur(12px);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 32px;
  animation: slideInUp 0.4s ease;
}

.journey-step-label {
  font-size: 0.85rem;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: var(--star-warm);
  margin-bottom: 8px;
}

.journey-step-title {
  font-size: 1.5rem;
  font-weight: 800;
  margin-bottom: 16px;
  color: var(--text-primary);
}

.journey-step-body {
  color: var(--text-muted);
  font-size: 0.95rem;
  line-height: 1.7;
  margin-bottom: 20px;
}

.journey-db-tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 14px;
  background: rgba(16,185,129,0.15);
  border: 1px solid rgba(16,185,129,0.3);
  border-radius: 20px;
  font-size: 0.8rem;
  color: var(--success);
  font-family: monospace;
}

.journey-visual {
  margin-top: 20px;
  border-radius: var(--radius-sm);
  overflow: hidden;
}

/* Simulated UI elements */
.sim-quest-card {
  background: rgba(75,85,160,0.4);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  padding: 16px 20px;
  display: flex;
  align-items: center;
  gap: 16px;
}

.sim-badge {
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 700;
}

.sim-badge-pending {
  background: rgba(251,191,36,0.2);
  border: 1px solid rgba(251,191,36,0.4);
  color: var(--star-warm);
  animation: pendingPulse 1.5s ease-in-out infinite;
}

.sim-badge-approved {
  background: rgba(16,185,129,0.2);
  border: 1px solid rgba(16,185,129,0.4);
  color: var(--success);
}

.sim-star-counter {
  font-size: 2.5rem;
  font-weight: 900;
  color: var(--star-gold);
  text-shadow: 0 0 20px rgba(255,215,0,0.5);
  text-align: center;
  margin-top: 8px;
}

#journey-nav {
  display: flex;
  gap: 16px;
  margin-top: 24px;
  justify-content: center;
}

.journey-btn {
  padding: 12px 28px;
  border-radius: var(--radius-sm);
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 2px solid transparent;
}

.journey-btn-prev {
  background: rgba(255,255,255,0.08);
  color: var(--text-muted);
  border-color: rgba(255,255,255,0.12);
}

.journey-btn-prev:hover {
  background: rgba(255,255,255,0.14);
  color: var(--text-primary);
}

.journey-btn-next {
  background: linear-gradient(135deg, var(--star-gold), var(--star-warm));
  color: var(--night-deep);
  font-weight: 700;
}

.journey-btn-next:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(255,215,0,0.4);
}

.journey-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  transform: none !important;
  box-shadow: none !important;
}

/* ============================================================
   SECTION 5: STAR ECONOMY
   ============================================================ */
#section-economy {
  background: linear-gradient(180deg, var(--night-swirl) 0%, var(--cosmic) 100%);
}

#economy-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 32px;
  width: 100%;
  max-width: 900px;
}

/* Quest matrix */
#quest-matrix {
  display: grid;
  grid-template-columns: 80px repeat(3, 1fr);
  grid-template-rows: 44px repeat(3, 1fr);
  gap: 4px;
}

.matrix-header {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.85rem;
  font-weight: 700;
  text-align: center;
  padding: 6px;
  border-radius: var(--radius-sm);
}

.matrix-header-bonus  { background: rgba(255,215,0,0.15); color: var(--star-gold); }
.matrix-header-duty   { background: rgba(239,68,68,0.12); color: var(--danger); }
.matrix-header-violation { background: rgba(245,158,11,0.12); color: var(--warning); }
.matrix-header-scope  { background: rgba(255,255,255,0.05); color: var(--text-muted); }
.matrix-row-label     {
  display: flex;
  align-items: center;
  font-size: 0.85rem;
  color: var(--text-muted);
  padding-right: 4px;
}

.matrix-cell {
  border-radius: var(--radius-sm);
  padding: 10px 8px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2px;
  border: 1px solid transparent;
  font-size: 0.85rem;
}

.matrix-cell:hover { transform: scale(1.06); border-color: var(--star-gold); }

.matrix-cell-bonus {
  background: rgba(255,215,0,0.1);
  color: var(--star-gold);
}

.matrix-cell-duty {
  background: rgba(239,68,68,0.1);
  color: var(--danger);
}

.matrix-cell-violation {
  background: rgba(245,158,11,0.1);
  color: var(--warning);
}

.matrix-stars {
  font-weight: 800;
  font-size: 1rem;
}

.matrix-range {
  font-size: 0.78rem;
  opacity: 0.7;
}

#matrix-tooltip {
  position: absolute;
  background: rgba(15,23,42,0.95);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-sm);
  padding: 12px 16px;
  font-size: 0.85rem;
  max-width: 220px;
  z-index: 100;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
}

#matrix-tooltip.visible { opacity: 1; }

/* Star flow diagram */
#star-flow {
  display: flex;
  flex-direction: column;
  gap: 16px;
  align-items: center;
}

.flow-node {
  padding: 14px 24px;
  border-radius: var(--radius);
  font-weight: 700;
  text-align: center;
  width: 180px;
  position: relative;
}

.flow-node-earn {
  background: rgba(255,215,0,0.15);
  border: 2px solid rgba(255,215,0,0.4);
  color: var(--star-gold);
}

.flow-node-balance {
  background: rgba(79,70,229,0.25);
  border: 2px solid rgba(79,70,229,0.5);
  color: #a5b4fc;
}

.flow-node-reward {
  background: rgba(16,185,129,0.15);
  border: 2px solid rgba(16,185,129,0.4);
  color: var(--success);
}

.flow-arrow-down {
  font-size: 1.5rem;
  color: var(--text-muted);
  line-height: 1;
}

.flow-animated-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--star-gold);
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  box-shadow: 0 0 8px rgba(255,215,0,0.7);
}

/* Credit diagram */
#credit-mini {
  margin-top: 20px;
  padding: 16px 20px;
  background: rgba(245,158,11,0.08);
  border: 1px solid rgba(245,158,11,0.25);
  border-radius: var(--radius);
  font-size: 0.85rem;
  text-align: center;
  width: 100%;
  max-width: 360px;
}

#credit-mini h4 {
  color: var(--warning);
  margin-bottom: 6px;
  font-size: 0.9rem;
}

#credit-mini p { color: var(--text-muted); line-height: 1.5; }

/* ============================================================
   SECTION 6: DATABASE
   ============================================================ */
#section-db {
  background: linear-gradient(180deg, var(--cosmic) 0%, #0a0f1a 100%);
}

#db-layout {
  width: 100%;
  max-width: 900px;
  display: flex;
  flex-direction: column;
  gap: 28px;
}

#schema-container {
  position: relative;
  overflow-x: auto;
  padding: 20px 0;
}

#schema-tables {
  display: flex;
  gap: 12px;
  align-items: flex-start;
  flex-wrap: wrap;
  justify-content: center;
}

.db-table {
  background: #0d1117;
  border: 1px solid rgba(16,185,129,0.25);
  border-radius: var(--radius-sm);
  min-width: 140px;
  overflow: hidden;
  font-family: 'SF Mono', 'Fira Code', monospace;
  font-size: 0.82rem;
  transition: all 0.2s ease;
}

.db-table:hover {
  border-color: rgba(255,215,0,0.4);
  box-shadow: 0 0 16px rgba(255,215,0,0.1);
}

.db-table.view-table {
  border: 2px solid rgba(255,215,0,0.5);
  box-shadow: 0 0 20px rgba(255,215,0,0.1);
}

.db-table-header {
  padding: 8px 12px;
  background: rgba(16,185,129,0.12);
  border-bottom: 1px solid rgba(16,185,129,0.2);
  font-weight: 700;
  color: var(--success);
  font-size: 0.85rem;
}

.db-table.view-table .db-table-header {
  background: rgba(255,215,0,0.1);
  color: var(--star-gold);
}

.db-table-row {
  padding: 5px 12px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  color: var(--text-muted);
  display: flex;
  align-items: center;
  gap: 6px;
  transition: all 0.3s;
}

.db-table-row:last-child { border-bottom: none; }

.db-table-row.pk { color: var(--star-warm); }
.db-table-row.fk { color: #a5b4fc; }
.db-table-row.highlight-insert { animation: rowInsert 1s ease forwards; }
.db-table-row.highlight-update { animation: goldFlash 0.8s ease 2; }

.col-icon { font-size: 0.78rem; opacity: 0.7; }

.db-rls-banner {
  padding: 12px 20px;
  background: rgba(79,70,229,0.15);
  border: 1px solid rgba(79,70,229,0.3);
  border-radius: var(--radius-sm);
  font-size: 0.85rem;
  color: #a5b4fc;
  text-align: center;
}

/* Interactive DB demo */
#db-demo {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

#db-demo-title {
  font-size: 1rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 4px;
}

#db-demo-btns {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.db-demo-btn {
  padding: 10px 22px;
  border-radius: var(--radius-sm);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  border: none;
  transition: all 0.2s ease;
}

.db-demo-btn-insert {
  background: linear-gradient(135deg, rgba(16,185,129,0.3), rgba(5,150,105,0.2));
  border: 1px solid rgba(16,185,129,0.5);
  color: var(--success);
}

.db-demo-btn-approve {
  background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(251,191,36,0.1));
  border: 1px solid rgba(255,215,0,0.4);
  color: var(--star-gold);
}

.db-demo-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
.db-demo-btn:active { transform: translateY(0); }

#db-live-table {
  background: #0d1117;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius-sm);
  overflow: hidden;
  font-family: 'SF Mono', 'Fira Code', monospace;
  font-size: 0.85rem;
}

#db-live-table-header {
  display: grid;
  grid-template-columns: 80px 160px 80px 80px 100px;
  padding: 8px 12px;
  background: rgba(255,255,255,0.05);
  border-bottom: 1px solid rgba(255,255,255,0.08);
  color: var(--text-muted);
  font-weight: 700;
  font-size: 0.82rem;
}

.db-live-row {
  display: grid;
  grid-template-columns: 80px 160px 80px 80px 100px;
  padding: 8px 12px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  color: var(--text-muted);
  transition: all 0.3s;
}

.db-live-row:last-child { border-bottom: none; }
.db-live-row .id-col { color: #a5b4fc; }
.db-live-row .desc-col { color: var(--text-primary); }
.db-live-row .stars-col { color: var(--star-gold); }

#db-balance-display {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 20px;
  background: rgba(255,215,0,0.08);
  border: 1px solid rgba(255,215,0,0.2);
  border-radius: var(--radius-sm);
  margin-top: 8px;
}

#db-balance-label { color: var(--text-muted); font-size: 0.85rem; }
#db-balance-value { font-size: 1.6rem; font-weight: 900; color: var(--star-gold); font-family: monospace; }

/* ============================================================
   SECTION 7: TECH STACK
   ============================================================ */
#section-tech {
  background: linear-gradient(180deg, #0a0f1a 0%, var(--night-deep) 100%);
}

#tech-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  width: 100%;
  max-width: 860px;
}

.tech-card-wrapper {
  perspective: 1000px;
  height: 200px;
  cursor: pointer;
}

.tech-card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.tech-card-wrapper.flipped .tech-card-inner { transform: rotateY(180deg); }

.tech-card-face {
  position: absolute;
  inset: 0;
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 12px;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  padding: 20px;
  text-align: center;
}

.tech-card-front {
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
}

.tech-card-back {
  background: #0d1117;
  border: 1px solid rgba(255,215,0,0.3);
  transform: rotateY(180deg);
  overflow: hidden;
}

.tech-card-emoji { font-size: 2.5rem; }
.tech-card-name { font-size: 1rem; font-weight: 700; color: var(--text-primary); }
.tech-card-tagline { font-size: 0.8rem; color: var(--text-muted); }

.tech-card-back pre {
  font-family: 'SF Mono', 'Fira Code', monospace;
  font-size: 0.82rem;
  color: #10B981;
  text-align: left;
  background: rgba(255,255,255,0.03);
  border-radius: var(--radius-sm);
  padding: 10px;
  width: 100%;
  white-space: pre-wrap;
  word-break: break-all;
  line-height: 1.5;
}

.tech-card-back .back-title {
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--star-gold);
  margin-bottom: 4px;
}

.tech-hint {
  font-size: 0.9rem;
  color: var(--text-muted);
  text-align: center;
  margin-top: 16px;
  opacity: 0.7;
}

/* ============================================================
   FOOTER
   ============================================================ */
#footer {
  padding: 40px 24px;
  text-align: center;
  background: var(--night-deep);
  border-top: 1px solid var(--glass-border);
}

#footer p {
  color: var(--text-muted);
  font-size: 1rem;
  margin-bottom: 8px;
}

#footer .brand {
  color: var(--star-gold);
  font-weight: 700;
  font-size: 1.15rem;
}

/* ============================================================
   RESPONSIVE
   ============================================================ */
@media (max-width: 768px) {
  section { padding: 60px 16px; }

  #twoworlds-grid {
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
  }

  #phone-frame-wrapper {
    grid-row: 2;
    padding: 20px 0;
  }

  #role-parent, #role-child {
    border-radius: var(--radius);
    text-align: left;
  }

  #role-parent .role-feature { flex-direction: row; }

  #economy-grid { grid-template-columns: 1fr; }

  #tech-grid { grid-template-columns: repeat(2, 1fr); }

  #db-live-table-header,
  .db-live-row { grid-template-columns: 60px 120px 60px 60px 80px; font-size: 0.78rem; }

  #arch-svg-panel { display: none; }
}

/* ============================================================
   BADGE STATUS
   ============================================================ */
.badge-pending {
  padding: 3px 10px;
  border-radius: 20px;
  background: rgba(251,191,36,0.15);
  border: 1px solid rgba(251,191,36,0.35);
  color: var(--star-warm);
  font-size: 0.85rem;
  font-weight: 700;
  animation: pendingPulse 1.5s ease-in-out infinite;
}

.badge-approved {
  padding: 3px 10px;
  border-radius: 20px;
  background: rgba(16,185,129,0.15);
  border: 1px solid rgba(16,185,129,0.35);
  color: var(--success);
  font-size: 0.85rem;
  font-weight: 700;
}

.badge-rejected {
  padding: 3px 10px;
  border-radius: 20px;
  background: rgba(239,68,68,0.15);
  border: 1px solid rgba(239,68,68,0.35);
  color: var(--danger);
  font-size: 0.85rem;
  font-weight: 700;
}

/* Utility */
.text-gold { color: var(--star-gold); }
.text-success { color: var(--success); }
.text-danger { color: var(--danger); }
.text-warning { color: var(--warning); }
.text-muted { color: var(--text-muted); }
.font-mono { font-family: 'SF Mono', 'Fira Code', monospace; }
.font-bold { font-weight: 700; }
.text-center { text-align: center; }
.mt-4 { margin-top: 16px; }
.mb-2 { margin-bottom: 8px; }

/* Language toggle */
#lang-toggle {
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  color: var(--text-primary);
  padding: 6px 14px;
  border-radius: 20px;
  cursor: pointer;
  font-size: 0.85rem;
  font-weight: 600;
  backdrop-filter: blur(8px);
  transition: all 0.25s ease;
  white-space: nowrap;
  letter-spacing: 0.02em;
}
#lang-toggle:hover {
  background: rgba(255,215,0,0.15);
  border-color: rgba(255,215,0,0.4);
  color: var(--star-gold);
}
@media (max-width: 600px) {
  #lang-toggle {
    padding: 5px 10px;
    font-size: 0.78rem;
  }
}
</style>
</head>
<body>

<!-- PROGRESS BAR -->
<div id="progress-bar"></div>

<!-- NAVIGATION -->
<nav id="nav">
  <div id="nav-brand">‚≠ê StarQuest</div>
  <div id="nav-dots">
    <div class="nav-dot active" data-target="section-hero" title="Hero" data-i18n-title="nav.hero"></div>
    <div class="nav-dot" data-target="section-arch" title="Architecture" data-i18n-title="nav.arch"></div>
    <div class="nav-dot" data-target="section-twoworlds" title="Two Worlds" data-i18n-title="nav.twoworlds"></div>
    <div class="nav-dot" data-target="section-journey" title="Quest Journey" data-i18n-title="nav.journey"></div>
    <div class="nav-dot" data-target="section-economy" title="Star Economy" data-i18n-title="nav.economy"></div>
    <div class="nav-dot" data-target="section-db" title="Database" data-i18n-title="nav.db"></div>
    <div class="nav-dot" data-target="section-tech" title="Tech Stack" data-i18n-title="nav.tech"></div>
  </div>
  <button id="lang-toggle" onclick="toggleLanguage()">üá∫üá∏ EN</button>
</nav>

<!-- ============================================================
     SECTION 1: HERO
     ============================================================ -->
<section id="section-hero">
  <canvas id="starfield-canvas"></canvas>

  <div id="floating-emojis">
    <span class="float-emoji" style="left:8%;animation-duration:12s;animation-delay:0s;font-size:2rem;">‚≠ê</span>
    <span class="float-emoji" style="left:22%;animation-duration:9s;animation-delay:2s;font-size:1.5rem;">‚ú®</span>
    <span class="float-emoji" style="left:38%;animation-duration:14s;animation-delay:1s;font-size:2.2rem;">üéÅ</span>
    <span class="float-emoji" style="left:55%;animation-duration:10s;animation-delay:3s;font-size:1.8rem;">üìã</span>
    <span class="float-emoji" style="left:72%;animation-duration:11s;animation-delay:0.5s;font-size:2rem;">üèÜ</span>
    <span class="float-emoji" style="left:85%;animation-duration:8s;animation-delay:4s;font-size:1.5rem;">‚≠ê</span>
    <span class="float-emoji" style="left:15%;animation-duration:13s;animation-delay:5s;font-size:1.8rem;">‚ú®</span>
    <span class="float-emoji" style="left:65%;animation-duration:10s;animation-delay:2.5s;font-size:1.6rem;">üéÅ</span>
  </div>

  <div id="hero-content">
    <h1 id="hero-title" data-i18n="hero.title">StarQuest:<br>How the Magic Works</h1>
    <p id="hero-subtitle-zh" data-i18n="hero.subtitleZh">ÊòüÈôÖ‰ªªÂä°ÔºöÈ≠îÊ≥ïÊòØÂ¶Ç‰ΩïËøê‰ΩúÁöÑ</p>
    <div id="hero-intro">
      <div id="hero-intro-tagline" data-i18n="hero.tagline">üöÄ A real-life star chart adventure for the whole family</div>
      <div class="hero-feature-row">
        <span class="hero-feature-icon">‚≠ê</span>
        <span data-i18n="hero.feature1">Kids earn shining stars by completing <strong>fun quests</strong></span>
      </div>
      <div class="hero-feature-row">
        <span class="hero-feature-icon">‚úÖ</span>
        <span data-i18n="hero.feature2">Parents set the adventures, approve requests, and watch children grow</span>
      </div>
      <div class="hero-feature-row" style="border-bottom:none">
        <span class="hero-feature-icon">üéÅ</span>
        <span data-i18n="hero.feature3">Spend stars to unlock <strong>awesome rewards!</strong></span>
      </div>
    </div>
    <p id="scroll-cue" data-i18n="hero.scrollCue">Scroll to explore the magic ‚Üì</p>
  </div>
</section>

<!-- ============================================================
     SECTION 2: ARCHITECTURE
     ============================================================ -->
<section id="section-arch">
  <div class="section-label" data-i18n="section2.label">Section 2</div>
  <h2 class="section-title" data-i18n="section2.title">The Big Picture üó∫Ô∏è</h2>
  <p class="section-subtitle reveal" data-i18n="section2.subtitle">
    StarQuest is built in <strong>three layers</strong> that talk to each other ‚Äî like floors in a magical building!
    Click each layer to see what lives inside.
  </p>

  <div style="display:flex;gap:16px;width:100%;max-width:800px;" class="reveal reveal-delay-1">
    <!-- SVG arrows panel -->
    <div id="arch-svg-panel">
      <svg id="arch-svg" width="50" height="560" viewBox="0 0 50 560">
        <!-- Arrow: Browser ‚Üî Server -->
        <line id="arrow-bs" x1="25" y1="90" x2="25" y2="290" stroke="rgba(255,255,255,0.15)" stroke-width="2" stroke-dasharray="6 4"/>
        <circle id="packet-down-1" cx="25" cy="90" r="5" fill="#FFD700" opacity="0"/>
        <circle id="packet-up-1" cx="25" cy="290" r="5" fill="#10B981" opacity="0"/>
        <!-- Arrowhead -->
        <polygon points="19,280 25,296 31,280" fill="rgba(255,255,255,0.3)"/>
        <polygon points="19,104 25,88 31,104" fill="rgba(255,255,255,0.3)"/>

        <!-- Arrow: Server ‚Üî DB -->
        <line id="arrow-sd" x1="25" y1="305" x2="25" y2="470" stroke="rgba(255,255,255,0.15)" stroke-width="2" stroke-dasharray="6 4"/>
        <circle id="packet-down-2" cx="25" cy="305" r="5" fill="#FFD700" opacity="0"/>
        <circle id="packet-up-2" cx="25" cy="470" r="5" fill="#10B981" opacity="0"/>
        <polygon points="19,460 25,476 31,460" fill="rgba(255,255,255,0.3)"/>
        <polygon points="19,315 25,299 31,315" fill="rgba(255,255,255,0.3)"/>

        <!-- Labels -->
        <text x="25" y="200" text-anchor="middle" fill="rgba(255,255,255,0.3)" font-size="9" transform="rotate(-90,25,200)" data-i18n="arch.arrow.reqRes">Request / Response</text>
        <text x="25" y="395" text-anchor="middle" fill="rgba(255,255,255,0.3)" font-size="9" transform="rotate(-90,25,395)" data-i18n="arch.arrow.sqlData">SQL / Data</text>
      </svg>
    </div>

    <!-- Arch layers -->
    <div id="arch-container" style="flex:1">
      <!-- Browser Layer -->
      <div class="arch-layer glass-card" id="arch-layer-browser" onclick="toggleArchLayer(this)">
        <div class="arch-layer-header">
          <div class="arch-layer-icon">üåê</div>
          <div class="arch-layer-text">
            <h3 data-i18n="arch.browser.title">Your Web Browser</h3>
            <p data-i18n="arch.browser.desc">The part you look at and click!</p>
          </div>
          <div class="arch-layer-chevron">‚ñº</div>
        </div>
        <div class="arch-detail">
          <div class="arch-detail-inner">
            <div class="arch-component-chip">
              <strong>React Components</strong>
              <span data-i18n="arch.browser.reactDesc">Like LEGO bricks ‚Äî each piece of the screen is a "component"</span>
            </div>
            <div class="arch-component-chip">
              <strong>Tailwind CSS</strong>
              <span data-i18n="arch.browser.tailwindDesc">Paint and brushes that make things look pretty</span>
            </div>
            <div class="arch-component-chip">
              <strong>Next.js (Client)</strong>
              <span data-i18n="arch.browser.nextClientDesc">Handles clicking, typing, and page transitions</span>
            </div>
            <div class="arch-component-chip">
              <strong>next-intl</strong>
              <span data-i18n="arch.browser.intlDesc">Speaks English üá¨üáß or Chinese üá®üá≥ ‚Äî you pick!</span>
            </div>
            <div class="arch-component-chip">
              <strong>Anime.js</strong>
              <span data-i18n="arch.browser.animeDesc">Makes things bounce, slide, and sparkle ‚ú®</span>
            </div>
            <div class="arch-component-chip">
              <strong>Canvas API</strong>
              <span data-i18n="arch.browser.canvasDesc">Draws the twinkling starfield in the background</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Server Layer -->
      <div class="arch-layer glass-card" id="arch-layer-server" onclick="toggleArchLayer(this)" style="margin-top:8px">
        <div class="arch-layer-header">
          <div class="arch-layer-icon">üß†</div>
          <div class="arch-layer-text">
            <h3 data-i18n="arch.server.title">Next.js Server</h3>
            <p data-i18n="arch.server.desc">The brain that prepares your pages!</p>
          </div>
          <div class="arch-layer-chevron">‚ñº</div>
        </div>
        <div class="arch-detail">
          <div class="arch-detail-inner">
            <div class="arch-component-chip">
              <strong>Server Components</strong>
              <span data-i18n="arch.server.componentsDesc">Pre-cook pages on the server before sending them ‚Äî super fast!</span>
            </div>
            <div class="arch-component-chip">
              <strong>API Routes</strong>
              <span data-i18n="arch.server.apiDesc">Secret doors for the app to talk to itself</span>
            </div>
            <div class="arch-component-chip">
              <strong>Middleware</strong>
              <span data-i18n="arch.server.middlewareDesc">Security guard at the front door ‚Äî checks your login badge</span>
            </div>
            <div class="arch-component-chip">
              <strong>Cron Jobs</strong>
              <span data-i18n="arch.server.cronDesc">Alarm clock tasks ‚Äî sends weekly reports automatically!</span>
            </div>
            <div class="arch-component-chip">
              <strong>Resend Email</strong>
              <span data-i18n="arch.server.emailDesc">Sends invitation and report emails to parents</span>
            </div>
            <div class="arch-component-chip">
              <strong>TypeScript</strong>
              <span data-i18n="arch.server.tsDesc">The rulebook ‚Äî makes sure nobody passes the wrong kind of data</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Database Layer -->
      <div class="arch-layer glass-card" id="arch-layer-db" onclick="toggleArchLayer(this)" style="margin-top:8px">
        <div class="arch-layer-header">
          <div class="arch-layer-icon">üóÑÔ∏è</div>
          <div class="arch-layer-text">
            <h3 data-i18n="arch.db.title">Supabase + PostgreSQL</h3>
            <p data-i18n="arch.db.desc">The giant filing cabinet that remembers everything!</p>
          </div>
          <div class="arch-layer-chevron">‚ñº</div>
        </div>
        <div class="arch-detail">
          <div class="arch-detail-inner">
            <div class="arch-component-chip">
              <strong>families</strong>
              <span data-i18n="arch.db.familiesDesc">Each family gets their own magical vault of data</span>
            </div>
            <div class="arch-component-chip">
              <strong>star_transactions</strong>
              <span data-i18n="arch.db.transactionsDesc">Every star earned or spent, forever recorded</span>
            </div>
            <div class="arch-component-chip">
              <strong>quests</strong>
              <span data-i18n="arch.db.questsDesc">All the adventures kids can go on</span>
            </div>
            <div class="arch-component-chip">
              <strong>rewards</strong>
              <span data-i18n="arch.db.rewardsDesc">The treasure chest of prizes to spend stars on</span>
            </div>
            <div class="arch-component-chip">
              <strong data-i18n="arch.db.rlsLabel">Row-Level Security</strong>
              <span data-i18n="arch.db.rlsDesc">üîí Magic spell: your family can ONLY see YOUR data!</span>
            </div>
            <div class="arch-component-chip">
              <strong>child_balances VIEW</strong>
              <span data-i18n="arch.db.balancesDesc">Auto-calculates how many stars each child has right now</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ============================================================
     SECTION 3: TWO WORLDS
     ============================================================ -->
<section id="section-twoworlds">
  <div class="section-label" data-i18n="section3.label">Section 3</div>
  <h2 class="section-title" data-i18n="section3.title">Two Worlds üåç</h2>
  <p class="section-subtitle reveal" data-i18n="section3.subtitle">
    StarQuest shows <strong>different things</strong> to parents and children.
    Click a side to see what each role can do!
  </p>

  <div id="twoworlds-grid" class="reveal reveal-delay-1">
    <!-- Parent side -->
    <div class="role-panel selected" id="role-parent" onclick="selectRole('parent')">
      <div class="role-header" data-i18n="worlds.parent.title">üë®‚Äçüë© Parent</div>
      <div class="role-tagline" data-i18n="worlds.parent.tagline">The Quest Master!</div>
      <div class="role-feature">
        <span class="role-feature-icon">‚úÖ</span>
        <span data-i18n="worlds.parent.f1">Approve star requests</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üìä</span>
        <span data-i18n="worlds.parent.f2">See all children</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">‚≠ê</span>
        <span data-i18n="worlds.parent.f3">Record stars directly</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üìã</span>
        <span data-i18n="worlds.parent.f4">Manage all quest types</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üìà</span>
        <span data-i18n="worlds.parent.f5">Weekly &amp; monthly reports</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">‚öôÔ∏è</span>
        <span data-i18n="worlds.parent.f6">Configure credit &amp; levels</span>
      </div>
    </div>

    <!-- Phone frame center -->
    <div id="phone-frame-wrapper">
      <div id="phone-frame">
        <div id="phone-notch"></div>
        <div id="phone-screen" data-role="parent">
          <div class="phone-app-header">
            ‚≠ê StarQuest ‚Äî Admin
          </div>
          <div id="phone-content-parent">
            <div class="phone-quest-card">
              <span>üìã</span>
              <span style="flex:1;font-size:0.82rem;">Emma: Help with Dishes</span>
              <span class="phone-badge badge-gold">+15 ‚≠ê</span>
            </div>
            <div class="phone-quest-card">
              <span>‚≠ê</span>
              <span style="flex:1;font-size:0.82rem;">Lucas: Read 30 min</span>
              <span class="phone-badge badge-gold">pending</span>
            </div>
            <div class="phone-quest-card">
              <span>üéÅ</span>
              <span style="flex:1;font-size:0.82rem;">Emma: Movie Night</span>
              <span class="phone-badge badge-green">approved</span>
            </div>
            <div class="phone-quest-card">
              <span>‚ö†Ô∏è</span>
              <span style="flex:1;font-size:0.82rem;">Lucas: Late for bed</span>
              <span class="phone-badge badge-red">-20 ‚≠ê</span>
            </div>
          </div>
        </div>
      </div>
      <div id="phone-role-label" data-i18n="worlds.phone.switchLabel">üëÜ Click a side to switch</div>
    </div>

    <!-- Child side -->
    <div class="role-panel" id="role-child" onclick="selectRole('child')">
      <div class="role-header" data-i18n="worlds.child.title">üëß Child</div>
      <div class="role-tagline" data-i18n="worlds.child.tagline">The Star Hunter!</div>
      <div class="role-feature">
        <span class="role-feature-icon">‚≠ê</span>
        <span data-i18n="worlds.child.f1">Bonus quests ONLY</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üìù</span>
        <span data-i18n="worlds.child.f2">Request stars with a note</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üéÅ</span>
        <span data-i18n="worlds.child.f3">Redeem rewards</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üìä</span>
        <span data-i18n="worlds.child.f4">My own history only</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üîÑ</span>
        <span data-i18n="worlds.child.f5">Resubmit rejected quests</span>
      </div>
      <div class="role-feature">
        <span class="role-feature-icon">üí∞</span>
        <span data-i18n="worlds.child.f6">Borrow stars (credit)</span>
      </div>
    </div>
  </div>

  <div id="twoworlds-insight" class="reveal reveal-delay-2" data-i18n="worlds.insight">
    üí° <strong>Key Insight:</strong> Children <em>NEVER</em> see Duty or Violation quests ‚Äî
    only the fun, optional bonus ones! This keeps the experience <strong>positive and encouraging</strong> üåü
  </div>
</section>

<!-- ============================================================
     SECTION 4: QUEST JOURNEY
     ============================================================ -->
<section id="section-journey">
  <div class="section-label" data-i18n="section4.label">Section 4</div>
  <h2 class="section-title" data-i18n="section4.title">The Quest Journey üöÄ</h2>
  <p class="section-subtitle reveal" data-i18n="section4.subtitle">
    Follow <strong>Emma</strong> as she completes a quest and earns stars!
    Click the arrows to step through the whole adventure.
  </p>

  <!-- Progress dots -->
  <div id="journey-progress" class="reveal">
    <!-- Filled dynamically by JS -->
  </div>

  <!-- Step card -->
  <div id="journey-stage" class="reveal reveal-delay-1">
    <div id="journey-step-card"></div>
  </div>

  <!-- Nav buttons -->
  <div id="journey-nav" class="reveal reveal-delay-2">
    <button class="journey-btn journey-btn-prev" id="journey-prev" onclick="journeyNav(-1)" data-i18n="journey.prev">‚Üê Prev</button>
    <button class="journey-btn journey-btn-next" id="journey-next" onclick="journeyNav(1)" data-i18n="journey.next">Next ‚Üí</button>
  </div>
</section>

<!-- ============================================================
     SECTION 5: STAR ECONOMY
     ============================================================ -->
<section id="section-economy">
  <div class="section-label" data-i18n="section5.label">Section 5</div>
  <h2 class="section-title" data-i18n="section5.title">The Star Economy üí∞</h2>
  <p class="section-subtitle reveal" data-i18n="section5.subtitle">
    Different quests earn (or lose!) different amounts of stars.
    Click any cell to learn more!
  </p>

  <div id="economy-grid" class="reveal" style="position:relative">
    <!-- Quest Matrix -->
    <div>
      <h3 style="color:var(--text-primary);margin-bottom:16px;font-size:1rem;font-weight:700;" data-i18n="matrix.title">Quest Matrix ‚Äî Stars by Type √ó Scope</h3>
      <div id="quest-matrix">
        <!-- Filled by JS -->
      </div>
      <p style="font-size:0.88rem;color:var(--text-muted);margin-top:12px;" data-i18n="matrix.clickHint">üëÜ Click any cell to see details</p>
    </div>

    <!-- Star Flow + Credit -->
    <div style="display:flex;flex-direction:column;align-items:center;gap:8px">
      <h3 style="color:var(--text-primary);margin-bottom:8px;font-size:1rem;font-weight:700;align-self:flex-start" data-i18n="flow.title">Star Flow Diagram</h3>

      <div id="star-flow">
        <div class="flow-node flow-node-earn">
          <span data-i18n="flow.earn">‚≠ê Earn Stars</span>
          <div style="font-size:0.88rem;opacity:0.7;font-weight:400;margin-top:4px" data-i18n="flow.earnSub">Complete quests ‚Üí parent approves</div>
        </div>
        <div class="flow-arrow-down">‚Üì</div>
        <div class="flow-node flow-node-balance" style="position:relative">
          <span data-i18n="flow.balance">üí∞ Star Balance</span>
          <div style="font-size:0.88rem;opacity:0.7;font-weight:400;margin-top:4px">child_balances VIEW</div>
          <div id="flow-dot" style="position:absolute;bottom:-6px;left:50%;transform:translateX(-50%);width:10px;height:10px;border-radius:50%;background:var(--star-gold);box-shadow:0 0 8px rgba(255,215,0,0.7);display:none"></div>
        </div>
        <div class="flow-arrow-down">‚Üì</div>
        <div class="flow-node flow-node-reward">
          <span data-i18n="flow.redeem">üéÅ Redeem Reward</span>
          <div style="font-size:0.88rem;opacity:0.7;font-weight:400;margin-top:4px" data-i18n="flow.redeemSub">Stars deducted ‚Üí parent confirms</div>
        </div>
      </div>

      <div id="credit-mini" class="reveal reveal-delay-2">
        <h4 data-i18n="credit.title">üí≥ Credit System</h4>
        <p data-i18n="credit.desc">Like a piggy bank loan! Kids can <strong>borrow stars</strong> when they run low.
        Each month, a small <em>interest charge</em> is automatically settled. üè¶</p>
        <div style="margin-top:8px;font-size:0.88rem;color:var(--star-warm);" data-i18n="credit.tables">
          Tables: <span class="font-mono">credit_settings</span> ¬∑ <span class="font-mono">credit_transactions</span> ¬∑ <span class="font-mono">interest_tiers</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Tooltip (absolute) -->
  <div id="matrix-tooltip"></div>
</section>

<!-- ============================================================
     SECTION 6: DATABASE
     ============================================================ -->
<section id="section-db">
  <div class="section-label" data-i18n="section6.label">Section 6</div>
  <h2 class="section-title" data-i18n="section6.title">The Database Memory üóÑÔ∏è</h2>
  <p class="section-subtitle reveal" data-i18n="section6.subtitle">
    Everything in StarQuest is saved in a <strong>PostgreSQL database</strong>.
    Tables hold the data, and arrows show how they connect!
  </p>

  <div id="db-layout">
    <!-- Schema visual -->
    <div id="schema-container" class="reveal">
      <div id="schema-tables">
        <!-- Tables filled by JS -->
      </div>
    </div>

    <div class="db-rls-banner reveal reveal-delay-1" data-i18n="db.rls">
      üîí <strong>Row-Level Security (RLS):</strong> Every table has a magic shield ‚Äî you can
      <em>only</em> read or write data that belongs to <strong>your own family</strong>. Even if someone
      guessed another family's ID, the database refuses! This is built right into PostgreSQL.
    </div>

    <!-- Interactive demo -->
    <div id="db-demo" class="reveal reveal-delay-2">
      <div id="db-demo-title" data-i18n="db.demoTitle">üéÆ Interactive Demo ‚Äî Try it yourself!</div>
      <div id="db-demo-btns">
        <button class="db-demo-btn db-demo-btn-insert" onclick="dbDemoInsert()" data-i18n="db.btnInsert">
          ‚ûï Emma completes a quest
        </button>
        <button class="db-demo-btn db-demo-btn-approve" onclick="dbDemoApprove()" id="btn-approve" disabled data-i18n="db.btnApprove">
          ‚úÖ Parent approves it
        </button>
      </div>

      <div id="db-live-table">
        <div id="db-live-table-header">
          <div>id</div>
          <div data-i18n="db.colDesc">description</div>
          <div data-i18n="db.colStars">stars</div>
          <div data-i18n="db.colStatus">status</div>
          <div data-i18n="db.colChild">child</div>
        </div>
        <div id="db-live-rows">
          <!-- Rows inserted by JS -->
        </div>
      </div>

      <div id="db-balance-display">
        <span id="db-balance-label" data-i18n="db.balanceLabel">‚≠ê Emma's Balance:</span>
        <span id="db-balance-value">265</span>
        <span style="color:var(--text-muted);font-size:0.8rem" data-i18n="db.balanceUnit">stars</span>
      </div>
    </div>
  </div>
</section>

<!-- ============================================================
     SECTION 7: TECH STACK
     ============================================================ -->
<section id="section-tech">
  <div class="section-label" data-i18n="section7.label">Section 7</div>
  <h2 class="section-title" data-i18n="section7.title">The Code Toolbox üß∞</h2>
  <p class="section-subtitle reveal" data-i18n="section7.subtitle">
    StarQuest is built with 6 amazing tools.
    <strong>Click any card</strong> to flip it and see real code!
  </p>

  <div id="tech-grid" class="reveal">
    <!-- Filled by JS -->
  </div>

  <p class="tech-hint reveal reveal-delay-1" data-i18n="tech.flipHint">üí° Hover or click any card to flip it!</p>

  <div style="margin-top:48px;padding:20px 32px;background:rgba(255,215,0,0.06);border:1px solid rgba(255,215,0,0.2);border-radius:var(--radius);max-width:600px;text-align:center" class="reveal reveal-delay-2">
    <div style="font-size:1.5rem;margin-bottom:12px">üéì</div>
    <div style="font-weight:700;color:var(--text-primary);margin-bottom:8px" data-i18n="closing.title">You made it to the end!</div>
    <div style="color:var(--text-muted);font-size:1.05rem;line-height:1.7" data-i18n="closing.body">
      StarQuest has <strong style="color:var(--star-gold)">2,752 tests</strong> to make sure everything works perfectly.
      It's bilingual üá¨üáßüá®üá≥, has a credit system üí≥, sends weekly reports üìß, and even has a demo mode üé≠!
      <br><br>
      All of this in one magical Next.js app ‚ú®
    </div>
  </div>
</section>

<!-- FOOTER -->
<div id="footer">
  <p class="brand">‚≠ê StarQuest ¬∑ Beluga Tempo ¬∑ È≤∏Âæã</p>
  <p data-i18n="footer.desc">A gamified family behavior tracking app ‚Äî built with Next.js 15 + Supabase</p>
  <p style="margin-top:8px;font-size:0.9rem" data-i18n="footer.stats">Production: starquest-kappa.vercel.app ¬∑ 2,752 tests ¬∑ ~99% coverage</p>
</div>

<!-- ============================================================
     JAVASCRIPT
     ============================================================ -->
<script>
/* ============================================================
   I18N ‚Äî BILINGUAL SUPPORT (EN / ZH-CN)
   ============================================================ */
let currentLang = 'en';
let currentRole = 'parent';

const TRANSLATIONS = {
  en: {
    // Page
    'page.title': 'StarQuest: How the Magic Works ‚ú®',

    // Nav
    'nav.hero': 'Hero',
    'nav.arch': 'Architecture',
    'nav.twoworlds': 'Two Worlds',
    'nav.journey': 'Quest Journey',
    'nav.economy': 'Star Economy',
    'nav.db': 'Database',
    'nav.tech': 'Tech Stack',

    // Hero
    'hero.title': 'StarQuest:<br>How the Magic Works',
    'hero.subtitleZh': 'ÊòüÈôÖ‰ªªÂä°ÔºöÈ≠îÊ≥ïÊòØÂ¶Ç‰ΩïËøê‰ΩúÁöÑ',
    'hero.tagline': 'üöÄ A real-life star chart adventure for the whole family',
    'hero.feature1': 'Kids earn shining stars by completing <strong>fun quests</strong>',
    'hero.feature2': 'Parents set the adventures, approve requests, and watch children grow',
    'hero.feature3': 'Spend stars to unlock <strong>awesome rewards!</strong>',
    'hero.scrollCue': 'Scroll to explore the magic ‚Üì',

    // Section 2: Architecture
    'section2.label': 'Section 2',
    'section2.title': 'The Big Picture üó∫Ô∏è',
    'section2.subtitle': 'StarQuest is built in <strong>three layers</strong> that talk to each other ‚Äî like floors in a magical building! Click each layer to see what lives inside.',
    'arch.arrow.reqRes': 'Request / Response',
    'arch.arrow.sqlData': 'SQL / Data',
    'arch.browser.title': 'Your Web Browser',
    'arch.browser.desc': 'The part you look at and click!',
    'arch.browser.reactDesc': 'Like LEGO bricks ‚Äî each piece of the screen is a "component"',
    'arch.browser.tailwindDesc': 'Paint and brushes that make things look pretty',
    'arch.browser.nextClientDesc': 'Handles clicking, typing, and page transitions',
    'arch.browser.intlDesc': 'Speaks English üá¨üáß or Chinese üá®üá≥ ‚Äî you pick!',
    'arch.browser.animeDesc': 'Makes things bounce, slide, and sparkle ‚ú®',
    'arch.browser.canvasDesc': 'Draws the twinkling starfield in the background',
    'arch.server.title': 'Next.js Server',
    'arch.server.desc': 'The brain that prepares your pages!',
    'arch.server.componentsDesc': 'Pre-cook pages on the server before sending them ‚Äî super fast!',
    'arch.server.apiDesc': 'Secret doors for the app to talk to itself',
    'arch.server.middlewareDesc': 'Security guard at the front door ‚Äî checks your login badge',
    'arch.server.cronDesc': 'Alarm clock tasks ‚Äî sends weekly reports automatically!',
    'arch.server.emailDesc': 'Sends invitation and report emails to parents',
    'arch.server.tsDesc': 'The rulebook ‚Äî makes sure nobody passes the wrong kind of data',
    'arch.db.title': 'Supabase + PostgreSQL',
    'arch.db.desc': 'The giant filing cabinet that remembers everything!',
    'arch.db.familiesDesc': 'Each family gets their own magical vault of data',
    'arch.db.transactionsDesc': 'Every star earned or spent, forever recorded',
    'arch.db.questsDesc': 'All the adventures kids can go on',
    'arch.db.rewardsDesc': 'The treasure chest of prizes to spend stars on',
    'arch.db.rlsLabel': 'Row-Level Security',
    'arch.db.rlsDesc': 'üîí Magic spell: your family can ONLY see YOUR data!',
    'arch.db.balancesDesc': 'Auto-calculates how many stars each child has right now',

    // Section 3: Two Worlds
    'section3.label': 'Section 3',
    'section3.title': 'Two Worlds üåç',
    'section3.subtitle': 'StarQuest shows <strong>different things</strong> to parents and children. Click a side to see what each role can do!',
    'worlds.parent.title': 'üë®‚Äçüë© Parent',
    'worlds.parent.tagline': 'The Quest Master!',
    'worlds.parent.f1': 'Approve star requests',
    'worlds.parent.f2': 'See all children',
    'worlds.parent.f3': 'Record stars directly',
    'worlds.parent.f4': 'Manage all quest types',
    'worlds.parent.f5': 'Weekly & monthly reports',
    'worlds.parent.f6': 'Configure credit & levels',
    'worlds.child.title': 'üëß Child',
    'worlds.child.tagline': 'The Star Hunter!',
    'worlds.child.f1': 'Bonus quests ONLY',
    'worlds.child.f2': 'Request stars with a note',
    'worlds.child.f3': 'Redeem rewards',
    'worlds.child.f4': 'My own history only',
    'worlds.child.f5': 'Resubmit rejected quests',
    'worlds.child.f6': 'Borrow stars (credit)',
    'worlds.phone.switchLabel': 'üëÜ Click a side to switch',
    'worlds.insight': 'üí° <strong>Key Insight:</strong> Children <em>NEVER</em> see Duty or Violation quests ‚Äî only the fun, optional bonus ones! This keeps the experience <strong>positive and encouraging</strong> üåü',

    // Section 4: Quest Journey
    'section4.label': 'Section 4',
    'section4.title': 'The Quest Journey üöÄ',
    'section4.subtitle': 'Follow <strong>Emma</strong> as she completes a quest and earns stars! Click the arrows to step through the whole adventure.',
    'journey.prev': '‚Üê Prev',
    'journey.next': 'Next ‚Üí',
    'journey.done': 'üéâ Done!',
    'journey.step0.label': 'Step 1 of 7',
    'journey.step0.title': 'üë®‚Äçüë© Parent Creates a Quest',
    'journey.step0.body': 'Mom opens StarQuest and creates a new quest called "Help with Dishes üçΩÔ∏è". She sets it as a <strong>Bonus Quest</strong> ‚Äî which means Emma can choose to do it for extra stars!',
    'journey.step1.label': 'Step 2 of 7',
    'journey.step1.title': 'üëß Emma Sees the Quest',
    'journey.step1.body': 'Emma opens her phone and the "Help with Dishes" card bounces in! She only sees <strong>bonus quests</strong> ‚Äî duty and violation quests are hidden so her experience stays fun and positive.',
    'journey.step2.label': 'Step 3 of 7',
    'journey.step2.title': 'üìù Emma Requests Stars',
    'journey.step2.body': 'Emma washes all the dishes and then taps "Request Stars". She adds a note: "I washed ALL the dishes AND put them away! ü´ß". The request goes to Mom for approval.',
    'journey.step3.label': 'Step 4 of 7',
    'journey.step3.title': '‚è≥ Request is Pending',
    'journey.step3.body': 'The request lands in the database with status <strong>"pending"</strong>. It glows yellow to show it\'s waiting. The source is set to <strong>"child_request"</strong> ‚Äî meaning Emma sent it herself.',
    'journey.step4.label': 'Step 5 of 7',
    'journey.step4.title': 'üë© Parent Reviews the Request',
    'journey.step4.body': 'Mom gets a notification and sees Emma\'s request with her note. She can approve it (give the stars) or reject it. The note helps Mom know Emma really did the work!',
    'journey.step5.label': 'Step 6 of 7',
    'journey.step5.title': '‚úÖ Quest Approved!',
    'journey.step5.body': 'Mom clicks Approve! The status in the database instantly changes from <strong>pending ‚Üí approved</strong>. The cell flashes gold, then settles green. The <code>reviewed_by</code> and <code>reviewed_at</code> fields are recorded.',
    'journey.step6.label': 'Step 7 of 7',
    'journey.step6.title': 'üåü Stars Earned!',
    'journey.step6.body': 'Emma\'s star balance automatically updates! The <strong>child_balances</strong> view recalculates everything instantly. Emma\'s balance jumps from 265 to 280 ‚Äî with a satisfying animated counter! üéâ',
    'journey.step0.visual': `
      <div class="journey-visual sim-quest-card" style="animation:starBounce 0.6s ease">
        <span style="font-size:1.5rem">üçΩÔ∏è</span>
        <div style="flex:1">
          <div style="font-weight:700;color:var(--text-primary)">Help with Dishes</div>
          <div style="font-size:0.8rem;color:var(--text-muted)">Bonus ¬∑ Family ¬∑ Chores</div>
        </div>
        <div><span style="color:var(--star-gold);font-weight:700;font-size:1.1rem">+15 ‚≠ê</span></div>
      </div>
      <div style="margin-top:8px;font-size:0.8rem;color:var(--text-muted);text-align:center">Saved to <span class="font-mono" style="color:var(--success)">quests</span> table</div>`,
    'journey.step1.visual': `
      <div class="journey-visual" style="background:rgba(75,85,160,0.2);border-radius:10px;padding:16px">
        <div style="font-size:0.88rem;color:var(--text-muted);margin-bottom:8px">Emma's quest list ‚Äî bonus only ‚≠ê</div>
        <div class="sim-quest-card" style="animation:starBounce 0.6s ease 0.1s both">
          <span style="font-size:1.3rem">üçΩÔ∏è</span>
          <span style="flex:1;font-size:0.85rem">Help with Dishes</span>
          <span style="color:var(--star-gold);font-weight:700">+15 ‚≠ê</span>
        </div>
        <div class="sim-quest-card" style="animation:starBounce 0.6s ease 0.25s both;margin-top:6px">
          <span style="font-size:1.3rem">üìö</span>
          <span style="flex:1;font-size:0.85rem">Read for 30 minutes</span>
          <span style="color:var(--star-gold);font-weight:700">+20 ‚≠ê</span>
        </div>
      </div>`,
    'journey.step2.visual': `
      <div class="journey-visual glass-card" style="font-size:0.85rem">
        <div style="font-weight:700;color:var(--text-primary);margin-bottom:12px">üìù Request Stars Modal</div>
        <div style="margin-bottom:10px">
          <div style="font-size:0.88rem;color:var(--text-muted);margin-bottom:4px">Quest</div>
          <div style="background:rgba(0,0,0,0.2);border-radius:6px;padding:8px">üçΩÔ∏è Help with Dishes (+15 ‚≠ê)</div>
        </div>
        <div style="margin-bottom:10px">
          <div style="font-size:0.88rem;color:var(--text-muted);margin-bottom:4px">My note to Mom</div>
          <div style="background:rgba(0,0,0,0.2);border-radius:6px;padding:8px;font-style:italic;color:var(--star-glow)">"I washed ALL the dishes AND put them away! ü´ß"</div>
        </div>
        <div style="background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(251,191,36,0.1));border:1px solid rgba(255,215,0,0.3);border-radius:6px;padding:10px;text-align:center;color:var(--star-gold);font-weight:700;cursor:pointer">
          ‚≠ê Submit Request
        </div>
      </div>`,
    'journey.step3.visual': `
      <div class="journey-visual" style="background:#0d1117;border-radius:8px;overflow:hidden;font-family:monospace;font-size:0.88rem">
        <div style="padding:8px 12px;background:rgba(255,255,255,0.05);color:var(--text-muted);font-size:0.82rem;font-weight:700">star_transactions</div>
        <div style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;color:var(--text-muted);font-size:0.78rem;border-bottom:1px solid rgba(255,255,255,0.05)">
          <div>child</div><div>quest</div><div>stars</div><div>status</div>
        </div>
        <div style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;animation:rowInsert 1s ease">
          <div style="color:#a5b4fc">Emma</div>
          <div style="color:var(--text-primary)">Help w/ Dishes</div>
          <div style="color:var(--star-gold)">+15</div>
          <div><span class="badge-pending">pending</span></div>
        </div>
      </div>`,
    'journey.step4.visual': `
      <div class="journey-visual glass-card" style="font-size:0.85rem">
        <div style="font-weight:700;color:var(--text-primary);margin-bottom:12px">‚úÖ Parent Review Panel</div>
        <div style="background:rgba(0,0,0,0.2);border-radius:8px;padding:12px;margin-bottom:12px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px">
            <span style="font-size:1.2rem">üçΩÔ∏è</span>
            <span style="font-weight:700">Help with Dishes</span>
            <span style="color:var(--star-gold);margin-left:auto">+15 ‚≠ê</span>
          </div>
          <div style="font-size:0.88rem;color:var(--star-glow);font-style:italic">"I washed ALL the dishes AND put them away! ü´ß"</div>
          <div style="font-size:0.82rem;color:var(--text-muted);margin-top:4px">‚Äî Emma, 2 min ago</div>
        </div>
        <div style="display:flex;gap:8px">
          <div style="flex:1;text-align:center;padding:10px;background:rgba(16,185,129,0.2);border:1px solid rgba(16,185,129,0.4);border-radius:6px;color:var(--success);font-weight:700;cursor:pointer">‚úÖ Approve</div>
          <div style="flex:1;text-align:center;padding:10px;background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2);border-radius:6px;color:var(--danger);font-weight:700;cursor:pointer">‚ùå Reject</div>
        </div>
      </div>`,
    'journey.step5.visual': `
      <div class="journey-visual" style="background:#0d1117;border-radius:8px;overflow:hidden;font-family:monospace;font-size:0.88rem">
        <div style="padding:8px 12px;background:rgba(255,255,255,0.05);color:var(--text-muted);font-size:0.82rem;font-weight:700">star_transactions ‚Äî UPDATED</div>
        <div style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;color:var(--text-muted);font-size:0.78rem;border-bottom:1px solid rgba(255,255,255,0.05)">
          <div>child</div><div>quest</div><div>stars</div><div>status</div>
        </div>
        <div id="journey-approval-row" style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;animation:goldFlash 0.8s ease 2">
          <div style="color:#a5b4fc">Emma</div>
          <div style="color:var(--text-primary)">Help w/ Dishes</div>
          <div style="color:var(--star-gold)">+15</div>
          <div><span class="badge-approved">approved</span></div>
        </div>
      </div>`,
    'journey.step6.visual': `
      <div class="journey-visual" style="text-align:center;padding:20px 0">
        <div style="font-size:0.85rem;color:var(--text-muted);margin-bottom:8px">child_balances VIEW ‚Äî Emma</div>
        <div class="sim-star-counter" id="journey-counter">265</div>
        <div style="font-size:0.85rem;color:var(--text-muted);margin-top:4px">‚≠ê stars</div>
        <div style="margin-top:16px;display:flex;justify-content:center;gap:8px">
          <span style="font-size:2rem;animation:starBounce 0.5s ease 0.3s both;display:inline-block">‚≠ê</span>
          <span style="font-size:2rem;animation:starBounce 0.5s ease 0.5s both;display:inline-block">‚≠ê</span>
          <span style="font-size:2rem;animation:starBounce 0.5s ease 0.7s both;display:inline-block">‚≠ê</span>
        </div>
        <div style="margin-top:12px;font-size:0.85rem;color:var(--success);font-weight:700">üéâ +15 stars added! Great job, Emma!</div>
      </div>`,

    // Section 5: Star Economy
    'section5.label': 'Section 5',
    'section5.title': 'The Star Economy üí∞',
    'section5.subtitle': 'Different quests earn (or lose!) different amounts of stars. Click any cell to learn more!',
    'matrix.title': 'Quest Matrix ‚Äî Stars by Type √ó Scope',
    'matrix.clickHint': 'üëÜ Click any cell to see details',
    'matrix.typeBonus': '‚≠ê Bonus',
    'matrix.typeDuty': 'üìã Duty',
    'matrix.typeViolation': '‚ö†Ô∏è Violation',
    'matrix.scopeSelf': 'üôã Self',
    'matrix.scopeFamily': 'üë®‚Äçüë© Family',
    'matrix.scopeOther': 'üåç Others',
    'matrix.bonus.self': 'Bonus ¬∑ Self-improvement quests earn 5‚Äì30 stars. Things like reading, exercising, or practicing music. The better the habit, the more stars!',
    'matrix.bonus.family': 'Bonus ¬∑ Family quests earn 10‚Äì25 stars. Helping wash dishes, tidying up, or taking care of a sibling counts here.',
    'matrix.bonus.other': 'Bonus ¬∑ Helping Others earns 10‚Äì25 stars (default 20). Volunteering, helping neighbors, or being kind at school.',
    'matrix.duty.self': 'Duty ¬∑ Not brushing teeth or doing homework deducts 5‚Äì15 stars. These are things you\'re expected to do every day!',
    'matrix.duty.family': 'Duty ¬∑ Skipping family responsibilities (like not helping at dinner) deducts 5‚Äì15 stars.',
    'matrix.duty.other': 'Duty ¬∑ Failing social responsibilities (like being rude to guests) deducts 5‚Äì15 stars.',
    'matrix.violation.self': 'Violation ¬∑ Serious rule-breaking deducts 10‚Äì50 stars! Hitting, lying, or breaking things on purpose. Think carefully before acting!',
    'matrix.violation.family': 'Violation ¬∑ Serious family violations (yelling at parents, big tantrums) cost 10‚Äì50 stars.',
    'matrix.violation.other': 'Violation ¬∑ Hurting friends or misbehaving badly outside the home costs 10‚Äì50 stars.',
    'flow.title': 'Star Flow Diagram',
    'flow.earn': '‚≠ê Earn Stars',
    'flow.earnSub': 'Complete quests ‚Üí parent approves',
    'flow.balance': 'üí∞ Star Balance',
    'flow.redeem': 'üéÅ Redeem Reward',
    'flow.redeemSub': 'Stars deducted ‚Üí parent confirms',
    'credit.title': 'üí≥ Credit System',
    'credit.desc': 'Like a piggy bank loan! Kids can <strong>borrow stars</strong> when they run low. Each month, a small <em>interest charge</em> is automatically settled. üè¶',
    'credit.tables': 'Tables: <span class="font-mono">credit_settings</span> ¬∑ <span class="font-mono">credit_transactions</span> ¬∑ <span class="font-mono">interest_tiers</span>',

    // Section 6: Database
    'section6.label': 'Section 6',
    'section6.title': 'The Database Memory üóÑÔ∏è',
    'section6.subtitle': 'Everything in StarQuest is saved in a <strong>PostgreSQL database</strong>. Tables hold the data, and arrows show how they connect!',
    'db.rls': 'üîí <strong>Row-Level Security (RLS):</strong> Every table has a magic shield ‚Äî you can <em>only</em> read or write data that belongs to <strong>your own family</strong>. Even if someone guessed another family\'s ID, the database refuses! This is built right into PostgreSQL.',
    'db.demoTitle': 'üéÆ Interactive Demo ‚Äî Try it yourself!',
    'db.btnInsert': '‚ûï Emma completes a quest',
    'db.btnApprove': '‚úÖ Parent approves it',
    'db.colDesc': 'description',
    'db.colStars': 'stars',
    'db.colStatus': 'status',
    'db.colChild': 'child',
    'db.balanceLabel': '‚≠ê Emma\'s Balance:',
    'db.balanceUnit': 'stars',
    'db.computed': '‚ú® Computed automatically!',
    'db.view': '(VIEW)',
    'db.demoDesc': 'Help with Dishes üçΩÔ∏è',
    'db.demoPending': 'pending',
    'db.demoApproved': 'approved',

    // Section 7: Tech Stack
    'section7.label': 'Section 7',
    'section7.title': 'The Code Toolbox üß∞',
    'section7.subtitle': 'StarQuest is built with 6 amazing tools. <strong>Click any card</strong> to flip it and see real code!',
    'tech.flipHint': 'üí° Hover or click any card to flip it!',
    'tech.nextjs.tagline': '"The chef that prepares pages"',
    'tech.nextjs.backTitle': 'Server Component',
    'tech.supabase.tagline': '"The filing cabinet"',
    'tech.supabase.backTitle': 'Database Query',
    'tech.tailwind.tagline': '"Paint and brushes"',
    'tech.tailwind.backTitle': 'Utility Classes',
    'tech.typescript.tagline': '"The rulebook"',
    'tech.typescript.backTitle': 'Type Safety',
    'tech.vercel.tagline': '"The mailman"',
    'tech.vercel.backTitle': 'Deploy Command',
    'tech.jest.tagline': '"The quality inspector"',
    'tech.jest.backTitle': '2,752 Tests!',

    // Closing & footer
    'closing.title': 'You made it to the end!',
    'closing.body': 'StarQuest has <strong style="color:var(--star-gold)">2,752 tests</strong> to make sure everything works perfectly. It\'s bilingual üá¨üáßüá®üá≥, has a credit system üí≥, sends weekly reports üìß, and even has a demo mode üé≠!<br><br>All of this in one magical Next.js app ‚ú®',
    'footer.desc': 'A gamified family behavior tracking app ‚Äî built with Next.js 15 + Supabase',
    'footer.stats': 'Production: starquest-kappa.vercel.app ¬∑ 2,752 tests ¬∑ ~99% coverage',

    // Phone content
    'phone.parent.header': '‚≠ê StarQuest ‚Äî Admin',
    'phone.parent.item1': 'Emma: Help with Dishes',
    'phone.parent.badge1': '+15 ‚≠ê',
    'phone.parent.item2': 'Lucas: Read 30 min',
    'phone.parent.badge2': 'pending',
    'phone.parent.item3': 'Emma: Movie Night',
    'phone.parent.badge3': 'approved',
    'phone.parent.item4': 'Lucas: Late for bed',
    'phone.parent.badge4': '-20 ‚≠ê',
    'phone.child.header': '‚≠ê StarQuest ‚Äî Emma üëß',
    'phone.child.balance': 'Balance:',
    'phone.child.balanceVal': '265 ‚≠ê',
    'phone.child.item1': 'Help with Dishes',
    'phone.child.badge1': '+15 ‚≠ê',
    'phone.child.item2': 'Read for 30 min',
    'phone.child.badge2': '+20 ‚≠ê',
    'phone.child.item3': 'Draw something!',
    'phone.child.badge3': '+15 ‚≠ê',
    'phone.child.noViolations': 'No duty or violations shown üòä'
  },

  zh: {
    // Page
    'page.title': 'Â§∫ÊòüÂ§ßÈóØÂÖ≥ÔºöÊè≠ÁßòÈ≠îÊ≥ï ‚ú®',

    // Nav
    'nav.hero': 'È¶ñÈ°µ',
    'nav.arch': 'Êû∂ÊûÑ',
    'nav.twoworlds': 'ÂèåÈáç‰∏ñÁïå',
    'nav.journey': '‰ªªÂä°ÊóÖÁ®ã',
    'nav.economy': 'ÊòüÊòüÁªèÊµé',
    'nav.db': 'Êï∞ÊçÆÂ∫ì',
    'nav.tech': 'ÊäÄÊúØÊ†à',

    // Hero
    'hero.title': 'Â§∫ÊòüÂ§ßÈóØÂÖ≥Ôºö<br>Êè≠ÁßòÈ≠îÊ≥ï',
    'hero.subtitleZh': 'StarQuest: How the Magic Works',
    'hero.tagline': 'üöÄ Â±û‰∫éÂÖ®ÂÆ∂‰∫∫ÁöÑÊòüÊòüÂÜíÈô©‰πãÊóÖ',
    'hero.feature1': 'Â≠©Â≠êÈÄöËøáÂÆåÊàê<strong>ÊúâË∂£ÁöÑ‰ªªÂä°</strong>Êù•Êî∂ÈõÜÈó™‰∫ÆÊòüÊòü',
    'hero.feature2': 'ÂÆ∂ÈïøËÆæÁΩÆÂÜíÈô©„ÄÅÂÆ°ÊâπËØ∑Ê±ÇÔºåÈô™‰º¥Â≠©Â≠êÊàêÈïø',
    'hero.feature3': 'Áî®ÊòüÊòüÂÖëÊç¢<strong>Ë∂ÖÊ£íÁöÑÂ•ñÂä±ÔºÅ</strong>',
    'hero.scrollCue': 'Âêë‰∏ãÊªëÂä®ÔºåÊé¢Á¥¢È≠îÊ≥ï ‚Üì',

    // Section 2: Architecture
    'section2.label': 'Á¨¨‰∫åÁ´†',
    'section2.title': 'ÂÖ®ÊôØÊ¶ÇËßà üó∫Ô∏è',
    'section2.subtitle': 'StarQuest Áî±<strong>‰∏â‰∏™Â±ÇÁ∫ß</strong>ÊûÑÊàêÔºåÂÆÉ‰ª¨Áõ∏‰∫íÂçè‰Ωú‚Äî‚ÄîÂ∞±ÂÉè‰∏ÄÊ†ãÈ≠îÊ≥ïÂ§ßÊ•ºÁöÑ‰∏çÂêåÊ•ºÂ±ÇÔºÅÁÇπÂáªÊØèÂ±ÇÁúãÁúãÈáåÈù¢‰ΩèÁùÄ‰ªÄ‰πà„ÄÇ',
    'arch.arrow.reqRes': 'ËØ∑Ê±Ç / ÂìçÂ∫î',
    'arch.arrow.sqlData': 'SQL / Êï∞ÊçÆ',
    'arch.browser.title': '‰Ω†ÁöÑÊµèËßàÂô®',
    'arch.browser.desc': '‰Ω†ÁúãÂà∞ÂíåÁÇπÂáªÁöÑÈÉ®ÂàÜÔºÅ',
    'arch.browser.reactDesc': 'ÂÉè‰πêÈ´òÁßØÊú®‚Äî‚ÄîÂ±èÂπï‰∏äÁöÑÊØè‰∏™ÈÉ®ÂàÜÈÉΩÊòØ‰∏Ä‰∏™"ÁªÑ‰ª∂"',
    'arch.browser.tailwindDesc': 'ËÆ©ÁïåÈù¢ÂèòÂæóÊºÇ‰∫ÆÁöÑÁîªÁ¨îÂíåÈ¢úÊñô',
    'arch.browser.nextClientDesc': 'Â§ÑÁêÜÁÇπÂáª„ÄÅËæìÂÖ•ÂíåÈ°µÈù¢Ë∑≥ËΩ¨',
    'arch.browser.intlDesc': '‰ºöËØ¥Ëã±ËØ≠ üá¨üáß Êàñ‰∏≠Êñá üá®üá≥‚Äî‚Äî‰Ω†Êù•ÈÄâÔºÅ',
    'arch.browser.animeDesc': 'ËÆ©ÂÖÉÁ¥†ÂºπË∑≥„ÄÅÊªëÂä®„ÄÅÈó™ÁÉÅ ‚ú®',
    'arch.browser.canvasDesc': 'ÁªòÂà∂ËÉåÊôØ‰∏≠Èó™ÁÉÅÁöÑÊòüÁ©∫',
    'arch.server.title': 'Next.js ÊúçÂä°Âô®',
    'arch.server.desc': 'ÂáÜÂ§áÈ°µÈù¢ÁöÑÂ§ßËÑëÔºÅ',
    'arch.server.componentsDesc': 'Âú®ÊúçÂä°Âô®‰∏äÈ¢ÑÂÖàÊ∏≤ÊüìÈ°µÈù¢ÂÜçÂèëÈÄÅ‚Äî‚ÄîË∂ÖÂø´ÔºÅ',
    'arch.server.apiDesc': 'Â∫îÁî®Ëá™ÊàëÈÄö‰ø°ÁöÑÁßòÂØÜÈÄöÈÅì',
    'arch.server.middlewareDesc': 'Èó®Âè£ÁöÑÂÆâ‰øù‚Äî‚ÄîÊ£ÄÊü•‰Ω†ÁöÑÁôªÂΩïÂá≠ËØÅ',
    'arch.server.cronDesc': 'ÂÆöÊó∂ÈóπÈíü‰ªªÂä°‚Äî‚ÄîËá™Âä®ÂèëÈÄÅÂë®Êä•ÔºÅ',
    'arch.server.emailDesc': 'ÂêëÂÆ∂ÈïøÂèëÈÄÅÈÇÄËØ∑ÂíåÊä•ÂëäÈÇÆ‰ª∂',
    'arch.server.tsDesc': 'ËßÑÂàôÊâãÂÜå‚Äî‚ÄîÁ°Æ‰øùÊï∞ÊçÆÁ±ªÂûãÊ≠£Á°ÆÊó†ËØØ',
    'arch.db.title': 'Supabase + PostgreSQL',
    'arch.db.desc': 'ËÆ∞‰Ωè‰∏ÄÂàáÁöÑË∂ÖÂ§ßÊñá‰ª∂ÊüúÔºÅ',
    'arch.db.familiesDesc': 'ÊØè‰∏™ÂÆ∂Â∫≠ÈÉΩÊúâËá™Â∑±ÁöÑÊï∞ÊçÆÈ≠îÊ≥ï‰øùÈô©ÁÆ±',
    'arch.db.transactionsDesc': 'ÊØèÈ¢óËé∑ÂæóÊàñ‰ΩøÁî®ÁöÑÊòüÊòüÔºåÊ∞∏‰πÖËÆ∞ÂΩï',
    'arch.db.questsDesc': 'Â≠©Â≠ê‰ª¨ÂèØ‰ª•ÊåëÊàòÁöÑÊâÄÊúâÂÜíÈô©‰ªªÂä°',
    'arch.db.rewardsDesc': 'ÂèØÁî®ÊòüÊòüÂÖëÊç¢Â•ñÂìÅÁöÑÂÆùÁÆ±',
    'arch.db.rlsLabel': 'Ë°åÁ∫ßÂÆâÂÖ®Á≠ñÁï•',
    'arch.db.rlsDesc': 'üîí È≠îÊ≥ïÂííËØ≠Ôºö‰Ω†ÁöÑÂÆ∂Â∫≠Âè™ËÉΩÁúãÂà∞Ëá™Â∑±ÁöÑÊï∞ÊçÆÔºÅ',
    'arch.db.balancesDesc': 'Ëá™Âä®ËÆ°ÁÆóÊØè‰∏™Â≠©Â≠êÂΩìÂâçÊã•ÊúâÁöÑÊòüÊòüÊï∞',

    // Section 3: Two Worlds
    'section3.label': 'Á¨¨‰∏âÁ´†',
    'section3.title': 'ÂèåÈáç‰∏ñÁïå üåç',
    'section3.subtitle': 'StarQuest ÁªôÂÆ∂ÈïøÂíåÂ≠©Â≠êÂ±ïÁ§∫<strong>‰∏çÂêåÁöÑÂÜÖÂÆπ</strong>„ÄÇÁÇπÂáª‰∏Ä‰æßÁúãÁúãÂêÑËá™ÁöÑÂäüËÉΩÔºÅ',
    'worlds.parent.title': 'üë®‚Äçüë© ÂÆ∂Èïø',
    'worlds.parent.tagline': '‰ªªÂä°Â§ßÂ∏àÔºÅ',
    'worlds.parent.f1': 'ÂÆ°ÊâπÊòüÊòüËØ∑Ê±Ç',
    'worlds.parent.f2': 'Êü•ÁúãÊâÄÊúâÂ≠©Â≠ê',
    'worlds.parent.f3': 'Áõ¥Êé•ËÆ∞ÂΩïÊòüÊòü',
    'worlds.parent.f4': 'ÁÆ°ÁêÜÊâÄÊúâ‰ªªÂä°Á±ªÂûã',
    'worlds.parent.f5': 'Âë®Êä•ÂíåÊúàÊä•',
    'worlds.parent.f6': 'ÈÖçÁΩÆ‰ø°Áî®ÂíåÁ≠âÁ∫ß',
    'worlds.child.title': 'üëß Â≠©Â≠ê',
    'worlds.child.tagline': 'ÊòüÊòüÁåé‰∫∫ÔºÅ',
    'worlds.child.f1': 'Âè™ÁúãÂ•ñÂä±‰ªªÂä°',
    'worlds.child.f2': 'ÈôÑÁïôË®ÄËØ∑Ê±ÇÊòüÊòü',
    'worlds.child.f3': 'ÂÖëÊç¢Â•ñÂä±',
    'worlds.child.f4': 'Âè™ÁúãËá™Â∑±ÁöÑËÆ∞ÂΩï',
    'worlds.child.f5': 'ÈáçÊñ∞Êèê‰∫§Ë¢´Êãí‰ªªÂä°',
    'worlds.child.f6': 'ÂÄüÁî®ÊòüÊòüÔºà‰ø°Áî®Ôºâ',
    'worlds.phone.switchLabel': 'üëÜ ÁÇπÂáª‰∏Ä‰æßÂàáÊç¢ËßÜÂõæ',
    'worlds.insight': 'üí° <strong>Ê†∏ÂøÉÊ¥ûÂØüÔºö</strong>Â≠©Â≠ê<em>Ê∞∏Ëøú‰∏ç‰ºö</em>ÁúãÂà∞Êó•Â∏∏‰πâÂä°ÊàñËøùËßÑ‰ªªÂä°‚Äî‚ÄîÂè™ËÉΩÁúãÂà∞ÊúâË∂£ÁöÑ„ÄÅÂèØÈÄâÁöÑÂ•ñÂä±‰ªªÂä°ÔºÅËøôËÆ©‰ΩìÈ™åÂßãÁªà<strong>ÁßØÊûÅ‰∏îÈºìËàû‰∫∫ÂøÉ</strong> üåü',

    // Section 4: Quest Journey
    'section4.label': 'Á¨¨ÂõõÁ´†',
    'section4.title': '‰ªªÂä°ÊóÖÁ®ã üöÄ',
    'section4.subtitle': 'Ë∑üÈöè <strong>Emma</strong> ÂÆåÊàê‰∏ÄÈ°π‰ªªÂä°Âπ∂ËµöÂèñÊòüÊòüÔºÅÁÇπÂáªÁÆ≠Â§¥ÈÄêÊ≠•‰ΩìÈ™åÊï¥‰∏™ÂÜíÈô©„ÄÇ',
    'journey.prev': '‚Üê ‰∏ä‰∏ÄÊ≠•',
    'journey.next': '‰∏ã‰∏ÄÊ≠• ‚Üí',
    'journey.done': 'üéâ ÂÆåÊàêÔºÅ',
    'journey.step0.label': 'Á¨¨ 1 Ê≠•ÔºàÂÖ± 7 Ê≠•Ôºâ',
    'journey.step0.title': 'üë®‚Äçüë© ÂÆ∂ÈïøÂàõÂª∫‰ªªÂä°',
    'journey.step0.body': 'Â¶àÂ¶àÊâìÂºÄÂ§∫ÊòüÂ§ßÈóØÂÖ≥ÔºåÂàõÂª∫‰∫Ü‰∏Ä‰∏™Âè´"Â∏ÆÂøôÊ¥óÁ¢ó üçΩÔ∏è"ÁöÑÊñ∞‰ªªÂä°„ÄÇÂ•πÂ∞ÜÂÖ∂ËÆæ‰∏∫<strong>Â•ñÂä±‰ªªÂä°</strong>‚Äî‚ÄîËøôÊÑèÂë≥ÁùÄ Emma ÂèØ‰ª•ÈÄâÊã©ÂÆåÊàêÂÆÉÊù•ËµöÂèñÈ¢ùÂ§ñÊòüÊòüÔºÅ',
    'journey.step1.label': 'Á¨¨ 2 Ê≠•ÔºàÂÖ± 7 Ê≠•Ôºâ',
    'journey.step1.title': 'üëß Emma ÁúãÂà∞‰∫Ü‰ªªÂä°',
    'journey.step1.body': 'Emma ÊâìÂºÄÊâãÊú∫Ôºå"Â∏ÆÂøôÊ¥óÁ¢ó"ÁöÑÂç°ÁâáÂºπ‰∫ÜÂá∫Êù•ÔºÅÂ•πÂè™ËÉΩÁúãÂà∞<strong>Â•ñÂä±‰ªªÂä°</strong>‚Äî‚ÄîÊó•Â∏∏‰πâÂä°ÂíåËøùËßÑ‰ªªÂä°Ë¢´ÈöêËóè‰∫ÜÔºåËÆ©Â•πÁöÑ‰ΩìÈ™åÂßãÁªàÊúâË∂£‰∏îÁßØÊûÅ„ÄÇ',
    'journey.step2.label': 'Á¨¨ 3 Ê≠•ÔºàÂÖ± 7 Ê≠•Ôºâ',
    'journey.step2.title': 'üìù Emma ËØ∑Ê±ÇÊòüÊòü',
    'journey.step2.body': 'Emma Ê¥óÂÆå‰∫ÜÊâÄÊúâÁ¢óÁ¢üÔºåÁÑ∂ÂêéÁÇπÂáª"ËØ∑Ê±ÇÊòüÊòü"„ÄÇÂ•πÈôÑ‰∏ä‰∫ÜÁïôË®ÄÔºö"ÊàëÊääÊâÄÊúâÁ¢óÁ¢üÈÉΩÊ¥ó‰∫ÜÔºåËøòÊîæÂ•Ω‰∫ÜÔºÅü´ß"„ÄÇËØ∑Ê±ÇÂèëÈÄÅÁªôÂ¶àÂ¶àÂÆ°Êâπ„ÄÇ',
    'journey.step3.label': 'Á¨¨ 4 Ê≠•ÔºàÂÖ± 7 Ê≠•Ôºâ',
    'journey.step3.title': '‚è≥ ËØ∑Ê±ÇÂæÖÂÆ°Êâπ',
    'journey.step3.body': 'ËØ∑Ê±ÇËøõÂÖ•Êï∞ÊçÆÂ∫ìÔºåÁä∂ÊÄÅ‰∏∫<strong>"ÂæÖÂÆ°Êâπ"</strong>„ÄÇÂÆÉÈó™ÁùÄÈªÑËâ≤ÂÖâËäíË°®Á§∫Ê≠£Âú®Á≠âÂæÖ„ÄÇÊù•Ê∫êÊ†áËÆ∞‰∏∫ <strong>"child_request"</strong>‚Äî‚ÄîË°®Á§∫ÊòØ Emma Ëá™Â∑±ÂèëÈÄÅÁöÑ„ÄÇ',
    'journey.step4.label': 'Á¨¨ 5 Ê≠•ÔºàÂÖ± 7 Ê≠•Ôºâ',
    'journey.step4.title': 'üë© ÂÆ∂ÈïøÂÆ°Ê†∏ËØ∑Ê±Ç',
    'journey.step4.body': 'Â¶àÂ¶àÊî∂Âà∞ÈÄöÁü•ÔºåÁúãÂà∞ Emma ÁöÑËØ∑Ê±ÇÂíåÂ•πÁöÑÁïôË®Ä„ÄÇÂ•πÂèØ‰ª•ÊâπÂáÜÔºàÁªôÊòüÊòüÔºâÊàñÊãíÁªù„ÄÇÁïôË®ÄÂ∏ÆÂä©Â¶àÂ¶àÁ°ÆËÆ§ Emma Á°ÆÂÆûÂÆåÊàê‰∫Ü‰ªªÂä°ÔºÅ',
    'journey.step5.label': 'Á¨¨ 6 Ê≠•ÔºàÂÖ± 7 Ê≠•Ôºâ',
    'journey.step5.title': '‚úÖ ‰ªªÂä°ÈÄöËøáÔºÅ',
    'journey.step5.body': 'Â¶àÂ¶àÁÇπÂáªÊâπÂáÜÔºÅÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÁä∂ÊÄÅÁ´ãÂç≥‰ªé<strong>ÂæÖÂÆ°Êâπ ‚Üí Â∑≤ÊâπÂáÜ</strong>ÂèòÂåñ„ÄÇÂçïÂÖÉÊ†ºÈó™ÁÉÅÈáëËâ≤ÔºåÁÑ∂ÂêéÂèò‰∏∫ÁªøËâ≤„ÄÇ<code>reviewed_by</code> Âíå <code>reviewed_at</code> Â≠óÊÆµË¢´ËÆ∞ÂΩï„ÄÇ',
    'journey.step6.label': 'Á¨¨ 7 Ê≠•ÔºàÂÖ± 7 Ê≠•Ôºâ',
    'journey.step6.title': 'üåü Ëé∑ÂæóÊòüÊòüÔºÅ',
    'journey.step6.body': 'Emma ÁöÑÊòüÊòü‰ΩôÈ¢ùËá™Âä®Êõ¥Êñ∞ÔºÅ<strong>child_balances</strong> ËßÜÂõæÁû¨Èó¥ÈáçÊñ∞ËÆ°ÁÆó„ÄÇEmma ÁöÑ‰ΩôÈ¢ù‰ªé 265 Ë∑≥Âà∞ 280‚Äî‚Äî‰º¥ÈöèÁùÄ‰ª§‰∫∫Êª°ÊÑèÁöÑÂä®ÁîªËÆ°Êï∞Âô®ÔºÅüéâ',
    'journey.step0.visual': `
      <div class="journey-visual sim-quest-card" style="animation:starBounce 0.6s ease">
        <span style="font-size:1.5rem">üçΩÔ∏è</span>
        <div style="flex:1">
          <div style="font-weight:700;color:var(--text-primary)">Â∏ÆÂøôÊ¥óÁ¢ó</div>
          <div style="font-size:0.8rem;color:var(--text-muted)">Â•ñÂä± ¬∑ ÂÆ∂Â∫≠ ¬∑ ÂÆ∂Âä°</div>
        </div>
        <div><span style="color:var(--star-gold);font-weight:700;font-size:1.1rem">+15 ‚≠ê</span></div>
      </div>
      <div style="margin-top:8px;font-size:0.8rem;color:var(--text-muted);text-align:center">Â∑≤‰øùÂ≠òÂà∞ <span class="font-mono" style="color:var(--success)">quests</span> Ë°®</div>`,
    'journey.step1.visual': `
      <div class="journey-visual" style="background:rgba(75,85,160,0.2);border-radius:10px;padding:16px">
        <div style="font-size:0.88rem;color:var(--text-muted);margin-bottom:8px">Emma ÁöÑ‰ªªÂä°ÂàóË°® ‚Äî ‰ªÖÂ•ñÂä±‰ªªÂä° ‚≠ê</div>
        <div class="sim-quest-card" style="animation:starBounce 0.6s ease 0.1s both">
          <span style="font-size:1.3rem">üçΩÔ∏è</span>
          <span style="flex:1;font-size:0.85rem">Â∏ÆÂøôÊ¥óÁ¢ó</span>
          <span style="color:var(--star-gold);font-weight:700">+15 ‚≠ê</span>
        </div>
        <div class="sim-quest-card" style="animation:starBounce 0.6s ease 0.25s both;margin-top:6px">
          <span style="font-size:1.3rem">üìö</span>
          <span style="flex:1;font-size:0.85rem">ÈòÖËØª30ÂàÜÈíü</span>
          <span style="color:var(--star-gold);font-weight:700">+20 ‚≠ê</span>
        </div>
      </div>`,
    'journey.step2.visual': `
      <div class="journey-visual glass-card" style="font-size:0.85rem">
        <div style="font-weight:700;color:var(--text-primary);margin-bottom:12px">üìù ËØ∑Ê±ÇÊòüÊòüÂºπÁ™ó</div>
        <div style="margin-bottom:10px">
          <div style="font-size:0.88rem;color:var(--text-muted);margin-bottom:4px">‰ªªÂä°</div>
          <div style="background:rgba(0,0,0,0.2);border-radius:6px;padding:8px">üçΩÔ∏è Â∏ÆÂøôÊ¥óÁ¢ó (+15 ‚≠ê)</div>
        </div>
        <div style="margin-bottom:10px">
          <div style="font-size:0.88rem;color:var(--text-muted);margin-bottom:4px">ÁªôÂ¶àÂ¶àÁöÑÁïôË®Ä</div>
          <div style="background:rgba(0,0,0,0.2);border-radius:6px;padding:8px;font-style:italic;color:var(--star-glow)">"ÊàëÊääÊâÄÊúâÁ¢óÁ¢üÈÉΩÊ¥ó‰∫ÜÔºåËøòÊîæÂ•Ω‰∫ÜÔºÅü´ß"</div>
        </div>
        <div style="background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(251,191,36,0.1));border:1px solid rgba(255,215,0,0.3);border-radius:6px;padding:10px;text-align:center;color:var(--star-gold);font-weight:700;cursor:pointer">
          ‚≠ê Êèê‰∫§ËØ∑Ê±Ç
        </div>
      </div>`,
    'journey.step3.visual': `
      <div class="journey-visual" style="background:#0d1117;border-radius:8px;overflow:hidden;font-family:monospace;font-size:0.88rem">
        <div style="padding:8px 12px;background:rgba(255,255,255,0.05);color:var(--text-muted);font-size:0.82rem;font-weight:700">star_transactions</div>
        <div style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;color:var(--text-muted);font-size:0.78rem;border-bottom:1px solid rgba(255,255,255,0.05)">
          <div>Â≠©Â≠ê</div><div>‰ªªÂä°</div><div>ÊòüÊòü</div><div>Áä∂ÊÄÅ</div>
        </div>
        <div style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;animation:rowInsert 1s ease">
          <div style="color:#a5b4fc">Emma</div>
          <div style="color:var(--text-primary)">Â∏ÆÂøôÊ¥óÁ¢ó</div>
          <div style="color:var(--star-gold)">+15</div>
          <div><span class="badge-pending">ÂæÖÂÆ°Êâπ</span></div>
        </div>
      </div>`,
    'journey.step4.visual': `
      <div class="journey-visual glass-card" style="font-size:0.85rem">
        <div style="font-weight:700;color:var(--text-primary);margin-bottom:12px">‚úÖ ÂÆ∂ÈïøÂÆ°Ê†∏Èù¢Êùø</div>
        <div style="background:rgba(0,0,0,0.2);border-radius:8px;padding:12px;margin-bottom:12px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px">
            <span style="font-size:1.2rem">üçΩÔ∏è</span>
            <span style="font-weight:700">Â∏ÆÂøôÊ¥óÁ¢ó</span>
            <span style="color:var(--star-gold);margin-left:auto">+15 ‚≠ê</span>
          </div>
          <div style="font-size:0.88rem;color:var(--star-glow);font-style:italic">"ÊàëÊääÊâÄÊúâÁ¢óÁ¢üÈÉΩÊ¥ó‰∫ÜÔºåËøòÊîæÂ•Ω‰∫ÜÔºÅü´ß"</div>
          <div style="font-size:0.82rem;color:var(--text-muted);margin-top:4px">‚Äî EmmaÔºå2 ÂàÜÈíüÂâç</div>
        </div>
        <div style="display:flex;gap:8px">
          <div style="flex:1;text-align:center;padding:10px;background:rgba(16,185,129,0.2);border:1px solid rgba(16,185,129,0.4);border-radius:6px;color:var(--success);font-weight:700;cursor:pointer">‚úÖ ÊâπÂáÜ</div>
          <div style="flex:1;text-align:center;padding:10px;background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.2);border-radius:6px;color:var(--danger);font-weight:700;cursor:pointer">‚ùå ÊãíÁªù</div>
        </div>
      </div>`,
    'journey.step5.visual': `
      <div class="journey-visual" style="background:#0d1117;border-radius:8px;overflow:hidden;font-family:monospace;font-size:0.88rem">
        <div style="padding:8px 12px;background:rgba(255,255,255,0.05);color:var(--text-muted);font-size:0.82rem;font-weight:700">star_transactions ‚Äî Â∑≤Êõ¥Êñ∞</div>
        <div style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;color:var(--text-muted);font-size:0.78rem;border-bottom:1px solid rgba(255,255,255,0.05)">
          <div>Â≠©Â≠ê</div><div>‰ªªÂä°</div><div>ÊòüÊòü</div><div>Áä∂ÊÄÅ</div>
        </div>
        <div id="journey-approval-row" style="padding:10px 12px;display:grid;grid-template-columns:100px 120px 60px 100px;gap:4px;animation:goldFlash 0.8s ease 2">
          <div style="color:#a5b4fc">Emma</div>
          <div style="color:var(--text-primary)">Â∏ÆÂøôÊ¥óÁ¢ó</div>
          <div style="color:var(--star-gold)">+15</div>
          <div><span class="badge-approved">Â∑≤ÊâπÂáÜ</span></div>
        </div>
      </div>`,
    'journey.step6.visual': `
      <div class="journey-visual" style="text-align:center;padding:20px 0">
        <div style="font-size:0.85rem;color:var(--text-muted);margin-bottom:8px">child_balances ËßÜÂõæ ‚Äî Emma</div>
        <div class="sim-star-counter" id="journey-counter">265</div>
        <div style="font-size:0.85rem;color:var(--text-muted);margin-top:4px">‚≠ê ÊòüÊòü</div>
        <div style="margin-top:16px;display:flex;justify-content:center;gap:8px">
          <span style="font-size:2rem;animation:starBounce 0.5s ease 0.3s both;display:inline-block">‚≠ê</span>
          <span style="font-size:2rem;animation:starBounce 0.5s ease 0.5s both;display:inline-block">‚≠ê</span>
          <span style="font-size:2rem;animation:starBounce 0.5s ease 0.7s both;display:inline-block">‚≠ê</span>
        </div>
        <div style="margin-top:12px;font-size:0.85rem;color:var(--success);font-weight:700">üéâ +15 ÊòüÊòüÂ∑≤Âà∞Ë¥¶ÔºÅÂÅöÂæóÂ•ΩÔºåEmmaÔºÅ</div>
      </div>`,

    // Section 5: Star Economy
    'section5.label': 'Á¨¨‰∫îÁ´†',
    'section5.title': 'ÊòüÊòüÁªèÊµé üí∞',
    'section5.subtitle': '‰∏çÂêåÁ±ªÂûãÁöÑ‰ªªÂä°‰ºöËµöÂèñÔºàÊàñÊâ£Èô§ÔºÅÔºâ‰∏çÂêåÊï∞ÈáèÁöÑÊòüÊòü„ÄÇÁÇπÂáª‰ªªÊÑèÊ†ºÂ≠ê‰∫ÜËß£Êõ¥Â§öÔºÅ',
    'matrix.title': '‰ªªÂä°Áü©Èòµ ‚Äî Á±ªÂûã √ó ËåÉÂõ¥ÁöÑÊòüÊòüÂØπÁÖßË°®',
    'matrix.clickHint': 'üëÜ ÁÇπÂáª‰ªªÊÑèÊ†ºÂ≠êÊü•ÁúãËØ¶ÊÉÖ',
    'matrix.typeBonus': '‚≠ê Â•ñÂä±',
    'matrix.typeDuty': 'üìã Êó•Â∏∏‰πâÂä°',
    'matrix.typeViolation': '‚ö†Ô∏è ËøùËßÑ',
    'matrix.scopeSelf': 'üôã Ëá™Êàë',
    'matrix.scopeFamily': 'üë®‚Äçüë© ÂÆ∂Â∫≠',
    'matrix.scopeOther': 'üåç ‰ªñ‰∫∫',
    'matrix.bonus.self': 'Â•ñÂä± ¬∑ Ëá™ÊàëÊèêÂçá‰ªªÂä°ÂèØËé∑Âæó 5‚Äì30 È¢óÊòü„ÄÇ‰æãÂ¶ÇÈòÖËØª„ÄÅËøêÂä®„ÄÅÁªÉ‰π†‰πêÂô®„ÄÇ‰π†ÊÉØË∂äÂ•ΩÔºåÊòüÊòüË∂äÂ§öÔºÅ',
    'matrix.bonus.family': 'Â•ñÂä± ¬∑ ÂÆ∂Â∫≠‰ªªÂä°ÂèØËé∑Âæó 10‚Äì25 È¢óÊòü„ÄÇÂ∏ÆÂøôÊ¥óÁ¢ó„ÄÅÊï¥ÁêÜÊàøÈó¥ÊàñÁÖßÈ°æÂºüÂºüÂ¶πÂ¶πÈÉΩÁÆóÂú®ÂÜÖ„ÄÇ',
    'matrix.bonus.other': 'Â•ñÂä± ¬∑ Â∏ÆÂä©‰ªñ‰∫∫ÂèØËé∑Âæó 10‚Äì25 È¢óÊòüÔºàÈªòËÆ§ 20 È¢óÔºâ„ÄÇÂÅöÂøóÊÑøËÄÖ„ÄÅÂ∏ÆÂä©ÈÇªÂ±ÖÊàñÂú®Â≠¶Ê†°Ë°®Áé∞ÂèãÂñÑ„ÄÇ',
    'matrix.duty.self': 'Êó•Â∏∏‰πâÂä° ¬∑ ‰∏çÂà∑ÁâôÊàñ‰∏çÂÅö‰Ωú‰∏öÊâ£ 5‚Äì15 È¢óÊòü„ÄÇËøô‰∫õÊòØ‰Ω†ÊØèÂ§©ÈÉΩÂ∫îËØ•ÂÅöÁöÑ‰∫ãÔºÅ',
    'matrix.duty.family': 'Êó•Â∏∏‰πâÂä° ¬∑ ÈÄÉÈÅøÂÆ∂Â∫≠Ë¥£‰ªªÔºàÂ¶Ç‰∏çÂ∏ÆÂøôÂÅöÈ•≠ÔºâÊâ£ 5‚Äì15 È¢óÊòü„ÄÇ',
    'matrix.duty.other': 'Êó•Â∏∏‰πâÂä° ¬∑ Êú™Â±•Ë°åÁ§æ‰∫§Ë¥£‰ªªÔºàÂ¶ÇÂØπÂÆ¢‰∫∫Êó†Á§ºÔºâÊâ£ 5‚Äì15 È¢óÊòü„ÄÇ',
    'matrix.violation.self': 'ËøùËßÑ ¬∑ ‰∏•ÈáçËøùËßÑÊâ£ 10‚Äì50 È¢óÊòüÔºÅÊâì‰∫∫„ÄÅËØ¥Ë∞éÊàñÊïÖÊÑèÁ†¥Âùè‰∏úË•ø„ÄÇ‰∏âÊÄùËÄåÂêéË°åÔºÅ',
    'matrix.violation.family': 'ËøùËßÑ ¬∑ ‰∏•ÈáçÁöÑÂÆ∂Â∫≠ËøùËßÑÔºàÂØπÁà∂ÊØçÂ§ßÂñäÂ§ßÂè´„ÄÅÂ§ßÂèëËÑæÊ∞îÔºâÊâ£ 10‚Äì50 È¢óÊòü„ÄÇ',
    'matrix.violation.other': 'ËøùËßÑ ¬∑ ‰º§ÂÆ≥ÊúãÂèãÊàñÂú®Â§ñÈù¢‰∏•Èáç‰∏çÁ´ØË°å‰∏∫Êâ£ 10‚Äì50 È¢óÊòü„ÄÇ',
    'flow.title': 'ÊòüÊòüÊµÅÂä®Âõæ',
    'flow.earn': '‚≠ê ËµöÂèñÊòüÊòü',
    'flow.earnSub': 'ÂÆåÊàê‰ªªÂä° ‚Üí ÂÆ∂ÈïøÊâπÂáÜ',
    'flow.balance': 'üí∞ ÊòüÊòü‰ΩôÈ¢ù',
    'flow.redeem': 'üéÅ ÂÖëÊç¢Â•ñÂä±',
    'flow.redeemSub': 'Êâ£Èô§ÊòüÊòü ‚Üí ÂÆ∂ÈïøÁ°ÆËÆ§',
    'credit.title': 'üí≥ ‰ø°Áî®Á≥ªÁªü',
    'credit.desc': 'ÂÉèÂ∞èÁå™Â≠òÈí±ÁΩêÁöÑË¥∑Ê¨æÔºÅÂ≠©Â≠ê‰ª¨ÂèØ‰ª•Âú®ÊòüÊòü‰∏çÂ§üÊó∂<strong>ÂÄüÁî®ÊòüÊòü</strong>„ÄÇÊØèÊúà‰ºöËá™Âä®ÁªìÁÆó‰∏ÄÁ¨îÂ∞èÈ¢ù<em>Âà©ÊÅØ</em>„ÄÇüè¶',
    'credit.tables': 'Êï∞ÊçÆË°®Ôºö<span class="font-mono">credit_settings</span> ¬∑ <span class="font-mono">credit_transactions</span> ¬∑ <span class="font-mono">interest_tiers</span>',

    // Section 6: Database
    'section6.label': 'Á¨¨ÂÖ≠Á´†',
    'section6.title': 'Êï∞ÊçÆÂ∫ìËÆ∞ÂøÜ üóÑÔ∏è',
    'section6.subtitle': 'StarQuest ‰∏≠ÁöÑ‰∏ÄÂàáÈÉΩ‰øùÂ≠òÂú® <strong>PostgreSQL Êï∞ÊçÆÂ∫ì</strong>‰∏≠„ÄÇË°®Ê†ºÂ≠òÂÇ®Êï∞ÊçÆÔºåÁÆ≠Â§¥Â±ïÁ§∫ÂÆÉ‰ª¨Â¶Ç‰ΩïÂÖ≥ËÅîÔºÅ',
    'db.rls': 'üîí <strong>Ë°åÁ∫ßÂÆâÂÖ®Á≠ñÁï• (RLS)Ôºö</strong>ÊØèÂº†Ë°®ÈÉΩÊúâÈ≠îÊ≥ïÊä§Áõæ‚Äî‚Äî‰Ω†<em>Âè™ËÉΩ</em>ËØªÂÜôÂ±û‰∫é<strong>Ëá™Â∑±ÂÆ∂Â∫≠</strong>ÁöÑÊï∞ÊçÆ„ÄÇÂç≥‰ΩøÊúâ‰∫∫ÁåúÂà∞‰∫ÜÂè¶‰∏Ä‰∏™ÂÆ∂Â∫≠ÁöÑ IDÔºåÊï∞ÊçÆÂ∫ì‰πü‰ºöÊãíÁªùÔºÅËøôÊòØ PostgreSQL ÁöÑÂÜÖÁΩÆÂäüËÉΩ„ÄÇ',
    'db.demoTitle': 'üéÆ ‰∫íÂä®ÊºîÁ§∫ ‚Äî Ëá™Â∑±ËØïËØïÂêßÔºÅ',
    'db.btnInsert': '‚ûï Emma ÂÆåÊàê‰∫Ü‰∏ÄÈ°π‰ªªÂä°',
    'db.btnApprove': '‚úÖ ÂÆ∂ÈïøÊâπÂáÜ',
    'db.colDesc': 'ÊèèËø∞',
    'db.colStars': 'ÊòüÊòü',
    'db.colStatus': 'Áä∂ÊÄÅ',
    'db.colChild': 'Â≠©Â≠ê',
    'db.balanceLabel': '‚≠ê Emma ÁöÑ‰ΩôÈ¢ùÔºö',
    'db.balanceUnit': 'ÊòüÊòü',
    'db.computed': '‚ú® Ëá™Âä®ËÆ°ÁÆóÔºÅ',
    'db.view': 'ÔºàËßÜÂõæÔºâ',
    'db.demoDesc': 'Â∏ÆÂøôÊ¥óÁ¢ó üçΩÔ∏è',
    'db.demoPending': 'ÂæÖÂÆ°Êâπ',
    'db.demoApproved': 'Â∑≤ÊâπÂáÜ',

    // Section 7: Tech Stack
    'section7.label': 'Á¨¨‰∏ÉÁ´†',
    'section7.title': '‰ª£Á†ÅÂ∑•ÂÖ∑ÁÆ± üß∞',
    'section7.subtitle': 'StarQuest ‰ΩøÁî® 6 ‰∏™Âº∫Â§ßÁöÑÂ∑•ÂÖ∑ÊûÑÂª∫„ÄÇ<strong>ÁÇπÂáª‰ªªÊÑèÂç°Áâá</strong>ÁøªËΩ¨Êü•ÁúãÁúüÂÆû‰ª£Á†ÅÔºÅ',
    'tech.flipHint': 'üí° ÊÇ¨ÂÅúÊàñÁÇπÂáªÂç°ÁâáÂç≥ÂèØÁøªËΩ¨ÔºÅ',
    'tech.nextjs.tagline': '"ÂáÜÂ§áÈ°µÈù¢ÁöÑÂ§ßÂé®"',
    'tech.nextjs.backTitle': 'ÊúçÂä°Âô®ÁªÑ‰ª∂',
    'tech.supabase.tagline': '"Ë∂ÖÂ§ßÊñá‰ª∂Êüú"',
    'tech.supabase.backTitle': 'Êï∞ÊçÆÂ∫ìÊü•ËØ¢',
    'tech.tailwind.tagline': '"ÁîªÁ¨îÂíåÈ¢úÊñô"',
    'tech.tailwind.backTitle': 'Â∑•ÂÖ∑Á±ªÊ†∑Âºè',
    'tech.typescript.tagline': '"ËßÑÂàôÊâãÂÜå"',
    'tech.typescript.backTitle': 'Á±ªÂûãÂÆâÂÖ®',
    'tech.vercel.tagline': '"Âø´ÈÄíÂëò"',
    'tech.vercel.backTitle': 'ÈÉ®ÁΩ≤ÂëΩ‰ª§',
    'tech.jest.tagline': '"Ë¥®Ê£ÄÂëò"',
    'tech.jest.backTitle': '2,752 ‰∏™ÊµãËØïÔºÅ',

    // Closing & footer
    'closing.title': '‰Ω†ÁúãÂÆå‰∫ÜÂÖ®ÈÉ®ÂÜÖÂÆπÔºÅ',
    'closing.body': 'StarQuest Êúâ <strong style="color:var(--star-gold)">2,752 ‰∏™ÊµãËØï</strong>Á°Æ‰øù‰∏ÄÂàáËøêË°åÂÆåÁæé„ÄÇÂÆÉÊîØÊåÅÂèåËØ≠ üá¨üáßüá®üá≥ÔºåÊúâ‰ø°Áî®Á≥ªÁªü üí≥ÔºåËá™Âä®ÂèëÈÄÅÂë®Êä• üìßÔºåÁîöËá≥ÊúâÊºîÁ§∫Ê®°Âºè üé≠ÔºÅ<br><br>ÊâÄÊúâËøô‰∫õÈÉΩÂú®‰∏Ä‰∏™Á•ûÂ•áÁöÑ Next.js Â∫îÁî®‰∏≠ ‚ú®',
    'footer.desc': 'Ê∏∏ÊàèÂåñÂÆ∂Â∫≠Ë°å‰∏∫ËøΩË∏™Â∫îÁî® ‚Äî Âü∫‰∫é Next.js 15 + Supabase ÊûÑÂª∫',
    'footer.stats': 'Áîü‰∫ßÁéØÂ¢ÉÔºöstarquest-kappa.vercel.app ¬∑ 2,752 ‰∏™ÊµãËØï ¬∑ ~99% Ë¶ÜÁõñÁéá',

    // Phone content
    'phone.parent.header': '‚≠ê Â§∫ÊòüÂ§ßÈóØÂÖ≥ ‚Äî ÂÆ∂Èïø‰∏≠ÂøÉ',
    'phone.parent.item1': 'EmmaÔºöÂ∏ÆÂøôÊ¥óÁ¢ó',
    'phone.parent.badge1': '+15 ‚≠ê',
    'phone.parent.item2': 'LucasÔºöÈòÖËØª30ÂàÜÈíü',
    'phone.parent.badge2': 'ÂæÖÂÆ°Êâπ',
    'phone.parent.item3': 'EmmaÔºöÁîµÂΩ±‰πãÂ§ú',
    'phone.parent.badge3': 'Â∑≤ÊâπÂáÜ',
    'phone.parent.item4': 'LucasÔºöÊôöÁù°',
    'phone.parent.badge4': '-20 ‚≠ê',
    'phone.child.header': '‚≠ê Â§∫ÊòüÂ§ßÈóØÂÖ≥ ‚Äî Emma üëß',
    'phone.child.balance': '‰ΩôÈ¢ùÔºö',
    'phone.child.balanceVal': '265 ‚≠ê',
    'phone.child.item1': 'Â∏ÆÂøôÊ¥óÁ¢ó',
    'phone.child.badge1': '+15 ‚≠ê',
    'phone.child.item2': 'ÈòÖËØª30ÂàÜÈíü',
    'phone.child.badge2': '+20 ‚≠ê',
    'phone.child.item3': 'ÁîªÂπÖÁîªÔºÅ',
    'phone.child.badge3': '+15 ‚≠ê',
    'phone.child.noViolations': 'Ê≤°ÊúâÊó•Â∏∏‰πâÂä°ÊàñËøùËßÑÊòæÁ§∫ üòä'
  }
};

function t(key) {
  return (TRANSLATIONS[currentLang] && TRANSLATIONS[currentLang][key])
    || (TRANSLATIONS.en[key])
    || key;
}

function detectLanguage() {
  // Priority: ?lang= query param > localStorage > default 'en'
  const params = new URLSearchParams(window.location.search);
  const paramLang = params.get('lang');
  if (paramLang === 'zh' || paramLang === 'zh-CN') return 'zh';
  if (paramLang === 'en') return 'en';

  const stored = localStorage.getItem('sq-viz-lang');
  if (stored === 'zh' || stored === 'en') return stored;

  return 'en';
}

function applyTranslations() {
  // Update page title and html lang
  document.title = t('page.title');
  document.documentElement.lang = currentLang === 'zh' ? 'zh-CN' : 'en';

  // Walk data-i18n elements ‚Äî set innerHTML
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    if (key) {
      // For SVG text elements, use textContent instead of innerHTML
      if (el instanceof SVGElement) {
        el.textContent = t(key);
      } else {
        el.innerHTML = t(key);
      }
    }
  });

  // Walk data-i18n-title elements ‚Äî set title attribute
  document.querySelectorAll('[data-i18n-title]').forEach(el => {
    const key = el.getAttribute('data-i18n-title');
    if (key) el.title = t(key);
  });

  // Re-render JS-driven sections
  renderQuestMatrix();
  renderTechCards();
  renderSchema();

  // Re-render journey step (uses t() internally)
  renderJourneyStep();

  // Re-render phone content
  const screen = document.getElementById('phone-screen');
  if (screen) screen.innerHTML = getPhoneContent(currentRole);
}

function toggleLanguage() {
  currentLang = currentLang === 'en' ? 'zh' : 'en';
  localStorage.setItem('sq-viz-lang', currentLang);

  // Update URL param without reload
  const url = new URL(window.location);
  url.searchParams.set('lang', currentLang === 'zh' ? 'zh-CN' : 'en');
  history.replaceState(null, '', url);

  // Update toggle button
  const btn = document.getElementById('lang-toggle');
  btn.textContent = currentLang === 'en' ? 'üá∫üá∏ EN' : 'üá®üá≥ ‰∏≠Êñá';

  applyTranslations();
}

function getPhoneContent(role) {
  if (role === 'child') {
    return `
      <div class="phone-app-header">${t('phone.child.header')}</div>
      <div style="display:flex;justify-content:space-between;padding:6px 0;font-size:0.82rem;color:var(--star-gold)">
        <span>${t('phone.child.balance')}</span><span style="font-weight:700">${t('phone.child.balanceVal')}</span>
      </div>
      <div class="phone-quest-card" style="animation:starBounce 0.4s ease 0.0s both">
        <span>üçΩÔ∏è</span><span style="flex:1;font-size:0.82rem">${t('phone.child.item1')}</span>
        <span class="phone-badge badge-gold">${t('phone.child.badge1')}</span>
      </div>
      <div class="phone-quest-card" style="animation:starBounce 0.4s ease 0.15s both">
        <span>üìö</span><span style="flex:1;font-size:0.82rem">${t('phone.child.item2')}</span>
        <span class="phone-badge badge-gold">${t('phone.child.badge2')}</span>
      </div>
      <div class="phone-quest-card" style="animation:starBounce 0.4s ease 0.3s both">
        <span>üé®</span><span style="flex:1;font-size:0.82rem">${t('phone.child.item3')}</span>
        <span class="phone-badge badge-gold">${t('phone.child.badge3')}</span>
      </div>
      <div style="text-align:center;padding:8px 0;font-size:0.82rem;color:var(--text-muted);font-style:italic">${t('phone.child.noViolations')}</div>
    `;
  }
  return `
    <div class="phone-app-header">${t('phone.parent.header')}</div>
    <div class="phone-quest-card" style="animation:starBounce 0.4s ease 0.0s both">
      <span>üìã</span><span style="flex:1;font-size:0.82rem">${t('phone.parent.item1')}</span>
      <span class="phone-badge badge-gold">${t('phone.parent.badge1')}</span>
    </div>
    <div class="phone-quest-card" style="animation:starBounce 0.4s ease 0.1s both">
      <span>‚≠ê</span><span style="flex:1;font-size:0.82rem">${t('phone.parent.item2')}</span>
      <span class="phone-badge badge-gold">${t('phone.parent.badge2')}</span>
    </div>
    <div class="phone-quest-card" style="animation:starBounce 0.4s ease 0.2s both">
      <span>üéÅ</span><span style="flex:1;font-size:0.82rem">${t('phone.parent.item3')}</span>
      <span class="phone-badge badge-green">${t('phone.parent.badge3')}</span>
    </div>
    <div class="phone-quest-card" style="animation:starBounce 0.4s ease 0.3s both">
      <span>‚ö†Ô∏è</span><span style="flex:1;font-size:0.82rem">${t('phone.parent.item4')}</span>
      <span class="phone-badge badge-red">${t('phone.parent.badge4')}</span>
    </div>
  `;
}

/* ============================================================
   CONSTANTS & DATA
   ============================================================ */
const JOURNEY_STEPS = [
  { labelKey: 'journey.step0.label', titleKey: 'journey.step0.title', bodyKey: 'journey.step0.body', visualKey: 'journey.step0.visual', db: null },
  { labelKey: 'journey.step1.label', titleKey: 'journey.step1.title', bodyKey: 'journey.step1.body', visualKey: 'journey.step1.visual', db: 'quests (type = bonus)' },
  { labelKey: 'journey.step2.label', titleKey: 'journey.step2.title', bodyKey: 'journey.step2.body', visualKey: 'journey.step2.visual', db: 'star_transactions INSERT' },
  { labelKey: 'journey.step3.label', titleKey: 'journey.step3.title', bodyKey: 'journey.step3.body', visualKey: 'journey.step3.visual', db: 'star_transactions (status = pending)' },
  { labelKey: 'journey.step4.label', titleKey: 'journey.step4.title', bodyKey: 'journey.step4.body', visualKey: 'journey.step4.visual', db: 'star_transactions (reviewed_by)' },
  { labelKey: 'journey.step5.label', titleKey: 'journey.step5.title', bodyKey: 'journey.step5.body', visualKey: 'journey.step5.visual', db: 'star_transactions (status = approved)' },
  { labelKey: 'journey.step6.label', titleKey: 'journey.step6.title', bodyKey: 'journey.step6.body', visualKey: 'journey.step6.visual', db: 'child_balances VIEW (recomputed)' }
];

const QUEST_MATRIX_DATA = {
  bonus: {
    self:   { stars: '+15 ‚≠ê', range: '5‚Äì30',  color: 'bonus', descKey: 'matrix.bonus.self' },
    family: { stars: '+15 ‚≠ê', range: '10‚Äì25', color: 'bonus', descKey: 'matrix.bonus.family' },
    other:  { stars: '+20 ‚≠ê', range: '10‚Äì25', color: 'bonus', descKey: 'matrix.bonus.other' }
  },
  duty: {
    self:   { stars: '-10 ‚≠ê', range: '-5 to -15', color: 'duty', descKey: 'matrix.duty.self' },
    family: { stars: '-10 ‚≠ê', range: '-5 to -15', color: 'duty', descKey: 'matrix.duty.family' },
    other:  { stars: '-10 ‚≠ê', range: '-5 to -15', color: 'duty', descKey: 'matrix.duty.other' }
  },
  violation: {
    self:   { stars: '-30 ‚≠ê', range: '-10 to -50', color: 'violation', descKey: 'matrix.violation.self' },
    family: { stars: '-30 ‚≠ê', range: '-10 to -50', color: 'violation', descKey: 'matrix.violation.family' },
    other:  { stars: '-30 ‚≠ê', range: '-10 to -50', color: 'violation', descKey: 'matrix.violation.other' }
  }
};

const TECH_CARDS = [
  { emoji: 'üçΩÔ∏è', name: 'Next.js 15', taglineKey: 'tech.nextjs.tagline', backTitleKey: 'tech.nextjs.backTitle',
    code: `export default async function Page() {\n  const quests = await fetchQuests();\n  return <QuestList quests={quests} />;\n}` },
  { emoji: 'üóÑÔ∏è', name: 'Supabase', taglineKey: 'tech.supabase.tagline', backTitleKey: 'tech.supabase.backTitle',
    code: `const { data } = await supabase\n  .from('quests')\n  .select('*')\n  .eq('family_id', id)\n  .eq('type', 'bonus');` },
  { emoji: 'üé®', name: 'Tailwind CSS', taglineKey: 'tech.tailwind.tagline', backTitleKey: 'tech.tailwind.backTitle',
    code: `<div className=\n  "bg-primary/20\n   rounded-lg p-4\n   border border-gold\n   backdrop-blur-sm">` },
  { emoji: 'üìè', name: 'TypeScript', taglineKey: 'tech.typescript.tagline', backTitleKey: 'tech.typescript.backTitle',
    code: `type QuestType =\n  | "duty"\n  | "bonus"\n  | "violation";\n\ntype QuestScope =\n  | "self" | "family"\n  | "other";` },
  { emoji: 'üìÆ', name: 'Vercel', taglineKey: 'tech.vercel.tagline', backTitleKey: 'tech.vercel.backTitle',
    code: `# Deploy to production:\nvercel --prod\n\n# Preview deploy:\nvercel\n\n# Env vars managed\n# in Vercel dashboard` },
  { emoji: 'üîç', name: 'Jest', taglineKey: 'tech.jest.tagline', backTitleKey: 'tech.jest.backTitle',
    code: `describe('getSuggestedStars', () => {\n  it('bonus self returns 15', () => {\n    const res = getSuggestedStars(\n      'bonus', 'self');\n    expect(res.default).toBe(15);\n  });\n});` }
];

const DB_TABLES = [
  {
    name: 'families',
    cols: [
      { label: 'id', type: 'pk' },
      { label: 'name', type: '' },
      { label: 'created_at', type: '' }
    ]
  },
  {
    name: 'users',
    cols: [
      { label: 'id', type: 'pk' },
      { label: 'family_id', type: 'fk' },
      { label: 'name', type: '' },
      { label: 'role', type: '' },
      { label: 'email', type: '' }
    ]
  },
  {
    name: 'quests',
    cols: [
      { label: 'id', type: 'pk' },
      { label: 'family_id', type: 'fk' },
      { label: 'name_en / zh', type: '' },
      { label: 'type', type: '' },
      { label: 'scope', type: '' },
      { label: 'stars', type: '' }
    ]
  },
  {
    name: 'star_transactions',
    cols: [
      { label: 'id', type: 'pk' },
      { label: 'child_id', type: 'fk' },
      { label: 'quest_id', type: 'fk' },
      { label: 'stars', type: '' },
      { label: 'status', type: '' },
      { label: 'child_note', type: '' }
    ]
  },
  {
    name: 'rewards',
    cols: [
      { label: 'id', type: 'pk' },
      { label: 'family_id', type: 'fk' },
      { label: 'name_en / zh', type: '' },
      { label: 'stars_cost', type: '' }
    ]
  },
  {
    name: 'redemptions',
    cols: [
      { label: 'id', type: 'pk' },
      { label: 'child_id', type: 'fk' },
      { label: 'reward_id', type: 'fk' },
      { label: 'status', type: '' }
    ]
  },
  {
    name: 'levels',
    cols: [
      { label: 'id', type: 'pk' },
      { label: 'family_id', type: 'fk' },
      { label: 'min_stars', type: '' },
      { label: 'title_en', type: '' }
    ]
  },
  {
    name: 'child_balances',
    isView: true,
    cols: [
      { label: 'child_id', type: 'fk' },
      { label: 'total_stars', type: '' },
      { label: 'spendable', type: '' },
      { label: 'level_title', type: '' }
    ]
  }
];

/* ============================================================
   STARFIELD
   ============================================================ */
function createStarfield(canvas) {
  const ctx = canvas.getContext('2d');
  let W, H, stars = [], shooters = [];
  let animId;

  function resize() {
    W = canvas.width = canvas.parentElement.offsetWidth;
    H = canvas.height = canvas.parentElement.offsetHeight;
    initStars();
  }

  function initStars() {
    stars = [];
    const count = Math.floor((W * H) / 3000);
    for (let i = 0; i < count; i++) {
      stars.push({
        x: Math.random() * W,
        y: Math.random() * H,
        r: Math.random() * 1.5 + 0.3,
        alpha: Math.random(),
        speed: Math.random() * 0.015 + 0.003,
        phase: Math.random() * Math.PI * 2
      });
    }
  }

  function spawnShooter() {
    shooters.push({
      x: Math.random() * W * 0.6,
      y: Math.random() * H * 0.4,
      len: Math.random() * 80 + 60,
      speed: Math.random() * 8 + 6,
      alpha: 1,
      angle: Math.PI / 5
    });
  }

  let frame = 0;
  function loop() {
    ctx.clearRect(0, 0, W, H);
    frame++;

    // Spawn shooting stars occasionally
    if (frame % 120 === 0 && Math.random() < 0.6) spawnShooter();

    // Draw stars
    const t = Date.now() / 1000;
    stars.forEach(s => {
      const a = 0.3 + 0.7 * (Math.sin(t * s.speed * 5 + s.phase) * 0.5 + 0.5);
      ctx.beginPath();
      ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(254,240,138,${a})`;
      ctx.fill();
    });

    // Draw shooting stars
    shooters = shooters.filter(s => s.alpha > 0.01);
    shooters.forEach(s => {
      const dx = Math.cos(s.angle) * s.len;
      const dy = Math.sin(s.angle) * s.len;
      const grad = ctx.createLinearGradient(s.x, s.y, s.x - dx, s.y - dy);
      grad.addColorStop(0, `rgba(255,245,200,${s.alpha})`);
      grad.addColorStop(1, 'rgba(255,245,200,0)');
      ctx.beginPath();
      ctx.moveTo(s.x, s.y);
      ctx.lineTo(s.x - dx, s.y - dy);
      ctx.strokeStyle = grad;
      ctx.lineWidth = 1.5;
      ctx.stroke();
      s.x += Math.cos(s.angle) * s.speed;
      s.y += Math.sin(s.angle) * s.speed;
      s.alpha *= 0.95;
    });

    animId = requestAnimationFrame(loop);
  }

  window.addEventListener('resize', resize);
  resize();
  loop();
}

/* ============================================================
   NAV & PROGRESS
   ============================================================ */
function initNav() {
  const dots = document.querySelectorAll('.nav-dot');
  const sections = Array.from(document.querySelectorAll('section'));
  const bar = document.getElementById('progress-bar');

  dots.forEach(dot => {
    dot.addEventListener('click', () => {
      const target = document.getElementById(dot.dataset.target);
      if (target) target.scrollIntoView({ behavior: 'smooth' });
    });
  });

  function onScroll() {
    const scrollTop = window.scrollY;
    const docH = document.body.scrollHeight - window.innerHeight;
    bar.style.width = `${Math.min(100, (scrollTop / docH) * 100)}%`;

    // Active section
    let activeIdx = 0;
    sections.forEach((sec, i) => {
      const rect = sec.getBoundingClientRect();
      if (rect.top <= window.innerHeight * 0.5) activeIdx = i;
    });
    dots.forEach((d, i) => d.classList.toggle('active', i === activeIdx));
  }

  window.addEventListener('scroll', onScroll, { passive: true });
}

/* ============================================================
   INTERSECTION OBSERVER ‚Äî SCROLL REVEAL
   ============================================================ */
function observeSections() {
  const reveals = document.querySelectorAll('.reveal');
  const io = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, { threshold: 0.12 });
  reveals.forEach(el => io.observe(el));
}

/* ============================================================
   SECTION 2: ARCHITECTURE
   ============================================================ */
function toggleArchLayer(el) {
  const isActive = el.classList.contains('active');
  // Collapse all
  document.querySelectorAll('.arch-layer').forEach(l => l.classList.remove('active'));
  if (!isActive) el.classList.add('active');
}

function animateArchArrows() {
  // Animate packet dots along arrows (repeated)
  function animatePacket(elId, startY, endY, delay, color) {
    const el = document.getElementById(elId);
    if (!el) return;
    function step() {
      anime({
        targets: el,
        cy: [startY, endY],
        opacity: [{ value: 1, duration: 100 }, { value: 1, duration: 1200 }, { value: 0, duration: 200 }],
        duration: 1500,
        delay: delay,
        easing: 'easeInOutQuad',
        complete: () => setTimeout(step, 800 + Math.random() * 1000)
      });
    }
    setTimeout(step, delay);
  }
  animatePacket('packet-down-1', 90, 285, 0, '#FFD700');
  animatePacket('packet-up-1', 290, 95, 800, '#10B981');
  animatePacket('packet-down-2', 305, 465, 400, '#FFD700');
  animatePacket('packet-up-2', 470, 310, 1200, '#10B981');
}

/* ============================================================
   SECTION 3: TWO WORLDS
   ============================================================ */
function selectRole(role) {
  currentRole = role;
  const parentEl = document.getElementById('role-parent');
  const childEl = document.getElementById('role-child');
  const screen = document.getElementById('phone-screen');

  parentEl.classList.toggle('selected', role === 'parent');
  childEl.classList.toggle('selected', role === 'child');

  screen.style.opacity = '0';
  setTimeout(() => {
    screen.innerHTML = getPhoneContent(role);
    screen.style.opacity = '1';
  }, 250);
}

/* ============================================================
   SECTION 4: JOURNEY
   ============================================================ */
let currentStep = 0;

function buildJourneyProgress() {
  const container = document.getElementById('journey-progress');
  container.innerHTML = '';
  JOURNEY_STEPS.forEach((_, i) => {
    if (i > 0) {
      const conn = document.createElement('div');
      conn.className = 'journey-connector' + (i <= currentStep ? ' done' : '');
      container.appendChild(conn);
    }
    const dot = document.createElement('div');
    dot.className = 'journey-dot' + (i === currentStep ? ' active' : i < currentStep ? ' done' : '');
    dot.textContent = i + 1;
    dot.onclick = () => { currentStep = i; renderJourneyStep(); };
    container.appendChild(dot);
  });
}

function renderJourneyStep() {
  const step = JOURNEY_STEPS[currentStep];
  const card = document.getElementById('journey-step-card');

  card.style.opacity = '0';
  card.style.transform = 'translateY(20px)';

  setTimeout(() => {
    card.innerHTML = `
      <div class="journey-step-label">${t(step.labelKey)}</div>
      <div class="journey-step-title">${t(step.titleKey)}</div>
      <div class="journey-step-body">${t(step.bodyKey)}</div>
      ${step.db ? `<div class="journey-db-tag">üóÑÔ∏è ${step.db}</div>` : ''}
      ${t(step.visualKey) || ''}
    `;

    card.style.transition = 'opacity 0.35s ease, transform 0.35s ease';
    card.style.opacity = '1';
    card.style.transform = 'translateY(0)';

    // Step 7: animate counter
    if (currentStep === 6) {
      setTimeout(() => {
        const counter = document.getElementById('journey-counter');
        if (counter) animateCounter(counter, 265, 280, 1200);
      }, 400);
    }

    buildJourneyProgress();

    // Update nav buttons
    document.getElementById('journey-prev').disabled = currentStep === 0;
    const nextBtn = document.getElementById('journey-next');
    nextBtn.disabled = currentStep === JOURNEY_STEPS.length - 1;
    nextBtn.textContent = currentStep === JOURNEY_STEPS.length - 1 ? t('journey.done') : t('journey.next');
  }, 200);
}

function journeyNav(dir) {
  currentStep = Math.max(0, Math.min(JOURNEY_STEPS.length - 1, currentStep + dir));
  renderJourneyStep();
}

/* ============================================================
   SECTION 5: QUEST MATRIX
   ============================================================ */
function renderQuestMatrix() {
  const container = document.getElementById('quest-matrix');
  const types = ['bonus', 'duty', 'violation'];
  const scopes = ['self', 'family', 'other'];
  const typeLabels = { bonus: t('matrix.typeBonus'), duty: t('matrix.typeDuty'), violation: t('matrix.typeViolation') };
  const scopeLabels = { self: t('matrix.scopeSelf'), family: t('matrix.scopeFamily'), other: t('matrix.scopeOther') };

  // Corner blank
  container.innerHTML = '<div></div>';

  // Column headers
  types.forEach(tp => {
    const h = document.createElement('div');
    h.className = `matrix-header matrix-header-${tp}`;
    h.textContent = typeLabels[tp];
    container.appendChild(h);
  });

  // Rows
  scopes.forEach(scope => {
    // Row label
    const label = document.createElement('div');
    label.className = 'matrix-row-label';
    label.textContent = scopeLabels[scope];
    container.appendChild(label);

    types.forEach(type => {
      const data = QUEST_MATRIX_DATA[type][scope];
      const cell = document.createElement('div');
      cell.className = `matrix-cell matrix-cell-${data.color}`;
      cell.innerHTML = `
        <div class="matrix-stars">${data.stars}</div>
        <div class="matrix-range">${data.range}</div>
      `;
      cell.addEventListener('click', (e) => showMatrixTooltip(e, t(data.descKey)));
      container.appendChild(cell);
    });
  });
}

function showMatrixTooltip(e, text) {
  const tip = document.getElementById('matrix-tooltip');
  tip.textContent = text;
  tip.classList.add('visible');

  const rect = e.target.getBoundingClientRect();
  const economyRect = document.getElementById('section-economy').getBoundingClientRect();
  tip.style.left = (rect.left - economyRect.left + rect.width / 2 - 110) + 'px';
  tip.style.top = (rect.bottom - economyRect.top + 8) + 'px';

  setTimeout(() => tip.classList.remove('visible'), 3000);
}

/* ============================================================
   SECTION 6: DATABASE SCHEMA
   ============================================================ */
function renderSchema() {
  const container = document.getElementById('schema-tables');
  container.innerHTML = '';
  DB_TABLES.forEach(table => {
    const box = document.createElement('div');
    box.className = 'db-table' + (table.isView ? ' view-table' : '');

    let header = table.isView
      ? `<div class="db-table-header">üëÅÔ∏è ${table.name} <span style="font-size:0.6rem;opacity:0.7">${t('db.view')}</span></div>`
      : `<div class="db-table-header">${table.name}</div>`;

    let rows = table.cols.map(col => {
      const icon = col.type === 'pk' ? 'üîë' : col.type === 'fk' ? 'üîó' : '¬∑';
      return `<div class="db-table-row ${col.type}"><span class="col-icon">${icon}</span>${col.label}</div>`;
    }).join('');

    box.innerHTML = header + rows;
    container.appendChild(box);

    if (table.isView) {
      const note = document.createElement('div');
      note.style.cssText = 'font-size:0.82rem;color:var(--star-gold);text-align:center;margin-top:4px';
      note.textContent = t('db.computed');
      container.appendChild(note);
    }
  });
}

/* ============================================================
   SECTION 6: DB INTERACTIVE DEMO
   ============================================================ */
let dbRowId = 1;
let dbDemoState = 'idle'; // idle | inserted | approved
let currentBalance = 265;

function dbDemoInsert() {
  if (dbDemoState !== 'idle') return;
  dbDemoState = 'inserted';

  const rowsEl = document.getElementById('db-live-rows');
  const newRow = document.createElement('div');
  newRow.className = 'db-live-row';
  newRow.id = `db-row-${dbRowId}`;
  newRow.innerHTML = `
    <div class="id-col">#${String(dbRowId).padStart(3,'0')}</div>
    <div class="desc-col">${t('db.demoDesc')}</div>
    <div class="stars-col">+15</div>
    <div><span class="badge-pending">${t('db.demoPending')}</span></div>
    <div style="color:#a5b4fc">Emma</div>
  `;
  rowsEl.appendChild(newRow);

  // Animate row in
  anime({
    targets: newRow,
    translateX: [-30, 0],
    opacity: [0, 1],
    duration: 600,
    easing: 'easeOutElastic(1, 0.8)'
  });

  document.getElementById('btn-approve').disabled = false;
}

function dbDemoApprove() {
  if (dbDemoState !== 'inserted') return;
  dbDemoState = 'approved';

  const row = document.getElementById(`db-row-${dbRowId}`);
  if (!row) return;

  // Flash gold then update badge
  anime({
    targets: row,
    backgroundColor: ['rgba(255,215,0,0.3)', 'transparent'],
    duration: 800,
    easing: 'easeOutQuad',
    complete: () => {
      const badgeEl = row.querySelector('.badge-pending');
      if (badgeEl) {
        badgeEl.className = 'badge-approved';
        badgeEl.textContent = t('db.demoApproved');
      }
    }
  });

  // Animate balance counter
  const balanceEl = document.getElementById('db-balance-value');
  const newBalance = currentBalance + 15;
  animateCounter(balanceEl, currentBalance, newBalance, 1000);
  currentBalance = newBalance;

  document.getElementById('btn-approve').disabled = true;

  // After a delay, allow another insert
  setTimeout(() => {
    dbRowId++;
    dbDemoState = 'idle';
  }, 1500);
}

/* ============================================================
   SECTION 7: TECH CARDS
   ============================================================ */
function renderTechCards() {
  const grid = document.getElementById('tech-grid');
  grid.innerHTML = '';
  TECH_CARDS.forEach((card, i) => {
    const wrapper = document.createElement('div');
    wrapper.className = 'tech-card-wrapper';
    wrapper.innerHTML = `
      <div class="tech-card-inner">
        <div class="tech-card-face tech-card-front">
          <div class="tech-card-emoji">${card.emoji}</div>
          <div class="tech-card-name">${card.name}</div>
          <div class="tech-card-tagline">${t(card.taglineKey)}</div>
        </div>
        <div class="tech-card-face tech-card-back">
          <div class="back-title">${t(card.backTitleKey)}</div>
          <pre>${card.code}</pre>
        </div>
      </div>
    `;
    wrapper.addEventListener('click', () => wrapper.classList.toggle('flipped'));
    wrapper.addEventListener('mouseenter', () => {
      if (!wrapper.classList.contains('flipped')) wrapper.classList.add('flipped');
    });
    wrapper.addEventListener('mouseleave', () => wrapper.classList.remove('flipped'));
    grid.appendChild(wrapper);
  });
}

/* ============================================================
   UTILITY: ANIMATE COUNTER
   ============================================================ */
function animateCounter(el, from, to, duration) {
  const start = performance.now();
  function tick(now) {
    const elapsed = now - start;
    const progress = Math.min(elapsed / duration, 1);
    // Ease out
    const eased = 1 - Math.pow(1 - progress, 3);
    const value = Math.round(from + (to - from) * eased);
    el.textContent = value;
    if (progress < 1) requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
}

/* ============================================================
   STAR FLOW ANIMATION
   ============================================================ */
function animateStarFlow() {
  const dot = document.getElementById('flow-dot');
  if (!dot) return;
  dot.style.display = 'block';

  function cycle() {
    anime({
      targets: dot,
      translateY: [0, 60],
      opacity: [1, 0],
      duration: 1200,
      easing: 'easeInQuad',
      complete: () => {
        dot.style.transform = 'translateX(-50%)';
        setTimeout(cycle, 600 + Math.random() * 800);
      }
    });
  }
  setTimeout(cycle, 1000);
}

/* ============================================================
   INIT
   ============================================================ */
document.addEventListener('DOMContentLoaded', () => {
  // Detect language and set toggle button text
  currentLang = detectLanguage();
  const langBtn = document.getElementById('lang-toggle');
  langBtn.textContent = currentLang === 'en' ? 'üá∫üá∏ EN' : 'üá®üá≥ ‰∏≠Êñá';

  // Section 1: Starfield
  const canvas = document.getElementById('starfield-canvas');
  createStarfield(canvas);

  // Nav
  initNav();

  // Scroll reveals
  observeSections();

  // Section 2: Architecture
  animateArchArrows();

  // Section 3: Phone frame init
  document.getElementById('phone-screen').innerHTML = getPhoneContent('parent');

  // Section 4: Journey
  buildJourneyProgress();
  renderJourneyStep();

  // Section 5: Matrix
  renderQuestMatrix();

  // Star flow animation (starts when section visible)
  const flowObserver = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        animateStarFlow();
        flowObserver.disconnect();
      }
    });
  }, { threshold: 0.3 });
  const economySection = document.getElementById('section-economy');
  if (economySection) flowObserver.observe(economySection);

  // Section 6: DB schema
  renderSchema();

  // Section 7: Tech cards
  renderTechCards();

  // Apply translations (updates all data-i18n elements)
  applyTranslations();

  // Keyboard arrow navigation for journey
  document.addEventListener('keydown', (e) => {
    const journeySection = document.getElementById('section-journey');
    const rect = journeySection.getBoundingClientRect();
    const inView = rect.top < window.innerHeight && rect.bottom > 0;
    if (!inView) return;
    if (e.key === 'ArrowRight' || e.key === 'ArrowDown') journeyNav(1);
    if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') journeyNav(-1);
  });
});
</script>
</body>
</html>
